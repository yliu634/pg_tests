SET
DROP AGGREGATE
CREATE AGGREGATE
DROP TABLE
CREATE TABLE
INSERT 0 6
psql:pg_tests/compatible/window.sql:37: ERROR:  window functions are not allowed in GROUP BY
LINE 1: SELECT * FROM kv GROUP BY v, count(w) OVER ();
                                     ^
psql:pg_tests/compatible/window.sql:42: ERROR:  window functions are not allowed in GROUP BY
LINE 1: SELECT count(w) OVER () FROM kv GROUP BY 1;
               ^
psql:pg_tests/compatible/window.sql:47: ERROR:  window functions are not allowed in RETURNING
LINE 1: INSERT INTO kv (k, v) VALUES (99, 100) RETURNING sum(v) OVER...
                                                         ^
psql:pg_tests/compatible/window.sql:52: ERROR:  window functions are not allowed in LIMIT
LINE 1: SELECT sum(v) FROM kv GROUP BY k LIMIT sum(v) OVER ();
                                               ^
psql:pg_tests/compatible/window.sql:57: ERROR:  window functions are not allowed in OFFSET
LINE 1: SELECT sum(v) FROM kv GROUP BY k LIMIT 1 OFFSET sum(v) OVER ...
                                                        ^
psql:pg_tests/compatible/window.sql:62: ERROR:  window functions are not allowed in VALUES
LINE 1: INSERT INTO kv (k, v) VALUES (99, count(1) OVER ());
                                          ^
psql:pg_tests/compatible/window.sql:67: ERROR:  window functions are not allowed in WHERE
LINE 1: SELECT k FROM kv WHERE avg(k) OVER () > 1;
                               ^
psql:pg_tests/compatible/window.sql:72: ERROR:  window functions are not allowed in HAVING
LINE 1: SELECT 1 FROM kv GROUP BY 1 HAVING sum(1) OVER (PARTITION BY...
                                           ^
        avg         
--------------------
 5.0000000000000000
 5.0000000000000000
 5.0000000000000000
 5.0000000000000000
 5.0000000000000000
 5.0000000000000000
(6 rows)

        avg         
--------------------
 4.6666666666666667
 4.6666666666666667
 4.6666666666666667
 5.0000000000000000
 5.5000000000000000
 5.5000000000000000
(6 rows)

        avg         
--------------------
 3.5000000000000000
 3.5000000000000000
 4.0000000000000000
 4.0000000000000000
 7.5000000000000000
 7.5000000000000000
(6 rows)

        avg         
--------------------
 4.2500000000000000
 4.2500000000000000
 4.2500000000000000
 4.2500000000000000
 6.5000000000000000
 6.5000000000000000
(6 rows)

        avg         
--------------------
 3.0000000000000000
 3.5000000000000000
 3.5000000000000000
 5.0000000000000000
 7.0000000000000000
 8.0000000000000000
(6 rows)

          avg           
------------------------
 1.00000000000000000000
     3.0000000000000000
     5.0000000000000000
     6.0000000000000000
     7.0000000000000000
     8.0000000000000000
(6 rows)

        avg         
--------------------
 5.0000000000000000
 5.0000000000000000
 5.5000000000000000
 5.5000000000000000
 7.5000000000000000
 7.5000000000000000
(6 rows)

        avg         
--------------------
 5.0000000000000000
 5.0000000000000000
 5.0000000000000000
 5.0000000000000000
 6.5000000000000000
 6.5000000000000000
(6 rows)

        avg         
--------------------
 5.0000000000000000
 5.4000000000000000
 5.5000000000000000
 5.5000000000000000
 7.5000000000000000
 8.0000000000000000
(6 rows)

        avg         
--------------------
 3.7500000000000000
 3.7500000000000000
 4.0000000000000000
 4.0000000000000000
 5.0000000000000000
 5.0000000000000000
(6 rows)

          avg           
------------------------
 1.00000000000000000000
     2.0000000000000000
     3.0000000000000000
     3.7500000000000000
     4.4000000000000000
     5.0000000000000000
(6 rows)

        avg         
--------------------
 3.7500000000000000
 3.7500000000000000
 4.0000000000000000
 4.0000000000000000
 5.0000000000000000
 5.0000000000000000
(6 rows)

        avg         
--------------------
 4.6666666666666667
 4.6666666666666667
 5.0000000000000000
 5.5000000000000000
 7.0000000000000000
 8.0000000000000000
(6 rows)

        avg         
--------------------
 4.6666666666666667
 4.6666666666666667
 5.0000000000000000
 5.5000000000000000
 7.0000000000000000
 8.0000000000000000
(6 rows)

        avg         
--------------------
 4.6666666666666667
 4.6666666666666667
 5.0000000000000000
 5.5000000000000000
 7.0000000000000000
 8.0000000000000000
(6 rows)

        avg         
--------------------
 4.6666666666666667
 4.6666666666666667
 5.0000000000000000
 5.5000000000000000
 7.0000000000000000
 8.0000000000000000
(6 rows)

 k | v | w |  d  |  f   | s | b |      i       |        avg         
---+---+---+-----+------+---+---+--------------+--------------------
 1 | 2 | 3 | 1.0 |    1 | a | t | 00:01:00     | 4.6666666666666667
 3 | 4 | 5 |   2 |    8 | a | t | 00:00:02     | 5.5000000000000000
 5 |   | 5 | 9.9 | -321 |   | f |              | 5.0000000000000000
 6 | 2 | 3 | 4.4 |  4.4 | b | t | 00:00:00.001 | 4.6666666666666667
 7 | 2 | 2 |   6 |  7.9 | b | t | 4 days       | 7.0000000000000000
 8 | 4 | 2 |   3 |    3 | A | f | 3 years      | 8.0000000000000000
(6 rows)

 k | v | w |  d  |  f   | s | b |      i       |        avg         
---+---+---+-----+------+---+---+--------------+--------------------
 1 | 2 | 3 | 1.0 |    1 | a | t | 00:01:00     | 4.6666666666666667
 6 | 2 | 3 | 4.4 |  4.4 | b | t | 00:00:00.001 | 4.6666666666666667
 5 |   | 5 | 9.9 | -321 |   | f |              | 5.0000000000000000
 3 | 4 | 5 |   2 |    8 | a | t | 00:00:02     | 5.5000000000000000
 7 | 2 | 2 |   6 |  7.9 | b | t | 4 days       | 7.0000000000000000
 8 | 4 | 2 |   3 |    3 | A | f | 3 years      | 8.0000000000000000
(6 rows)

 k | v | w |  d  |  f   | s | b |      i       
---+---+---+-----+------+---+---+--------------
 8 | 4 | 2 |   3 |    3 | A | f | 3 years
 7 | 2 | 2 |   6 |  7.9 | b | t | 4 days
 3 | 4 | 5 |   2 |    8 | a | t | 00:00:02
 5 |   | 5 | 9.9 | -321 |   | f | 
 1 | 2 | 3 | 1.0 |    1 | a | t | 00:01:00
 6 | 2 | 3 | 4.4 |  4.4 | b | t | 00:00:00.001
(6 rows)

        avg         
--------------------
 5.0000000000000000
 5.0000000000000000
 5.0000000000000000
 5.0000000000000000
 5.0000000000000000
 5.0000000000000000
(6 rows)

psql:pg_tests/compatible/window.sql:137: ERROR:  window "x" does not exist
LINE 1: SELECT avg(k) OVER x FROM kv WINDOW w AS ();
                           ^
psql:pg_tests/compatible/window.sql:142: ERROR:  window "x" does not exist
LINE 1: SELECT avg(k) OVER (x) FROM kv WINDOW w AS ();
                           ^
psql:pg_tests/compatible/window.sql:147: ERROR:  cannot override PARTITION BY clause of window "w"
LINE 1: SELECT avg(k) OVER (w PARTITION BY v) FROM kv WINDOW w AS ()...
                           ^
psql:pg_tests/compatible/window.sql:152: ERROR:  cannot override PARTITION BY clause of window "w"
LINE 1: SELECT avg(k) OVER (w PARTITION BY v) FROM kv WINDOW w AS (P...
                           ^
psql:pg_tests/compatible/window.sql:157: ERROR:  cannot override ORDER BY clause of window "w"
LINE 1: SELECT avg(k) OVER (w ORDER BY v) FROM kv WINDOW w AS (ORDER...
                           ^
psql:pg_tests/compatible/window.sql:162: ERROR:  column "a" does not exist
LINE 1: SELECT avg(k) OVER (PARTITION BY a) FROM kv;
                                         ^
psql:pg_tests/compatible/window.sql:167: ERROR:  column "a" does not exist
LINE 1: SELECT avg(k) OVER (ORDER BY a) FROM kv;
                                     ^
psql:pg_tests/compatible/window.sql:174: ERROR:  aggregate function calls cannot contain window function calls
LINE 1: SELECT avg(avg(k) OVER ()) FROM kv ORDER BY 1;
                   ^
        avg         
--------------------
 5.0000000000000000
(1 row)

        avg         |        avg         
--------------------+--------------------
 5.0000000000000000 | 2.8000000000000000
 5.0000000000000000 | 2.8000000000000000
 5.0000000000000000 | 2.8000000000000000
 5.0000000000000000 | 2.8000000000000000
 5.0000000000000000 | 2.8000000000000000
 5.0000000000000000 | 2.8000000000000000
(6 rows)

psql:pg_tests/compatible/window.sql:186: ERROR:  OVER specified, but now is not a window function nor an aggregate function
LINE 1: SELECT now() OVER () FROM kv ORDER BY 1;
               ^
psql:pg_tests/compatible/window.sql:191: ERROR:  window function rank requires an OVER clause
LINE 1: SELECT rank() FROM kv;
               ^
psql:pg_tests/compatible/window.sql:196: ERROR:  WITHIN GROUP is required for ordered-set aggregate rank
LINE 1: SELECT rank(22) FROM kv;
               ^
psql:pg_tests/compatible/window.sql:201: ERROR:  window function calls cannot be nested
LINE 1: SELECT avg(avg(k) OVER ()) OVER () FROM kv ORDER BY 1;
                   ^
psql:pg_tests/compatible/window.sql:206: ERROR:  OVER specified, but round is not a window function nor an aggregate function
LINE 1: SELECT round(avg(k) OVER ()) OVER () FROM kv ORDER BY 1;
               ^
 round 
-------
     5
     5
     5
     6
     7
     8
(6 rows)

        avg        
-------------------
              -321
                 3
 4.433333333333334
 4.433333333333334
               5.5
               7.9
(6 rows)

        avg         
--------------------
 2.5000000000000000
 3.0000000000000000
 3.8000000000000000
 3.8000000000000000
 6.0000000000000000
 9.9000000000000000
(6 rows)

        avg         
--------------------
 2.0000000000000000
 2.7000000000000000
 2.7000000000000000
 4.5000000000000000
 5.9500000000000000
 6.0000000000000000
(6 rows)

      ?column?       
---------------------
  5.0000000000000000
  6.0000000000000000
  7.6000000000000000
  7.6000000000000000
 12.0000000000000000
 19.8000000000000000
(6 rows)

      ?column?       
---------------------
  4.5000000000000000
  6.5000000000000000
  6.5000000000000000
  7.5000000000000000
 12.0000000000000000
 15.8500000000000000
(6 rows)

 avg 
-----
(0 rows)

 avg 
-----
(0 rows)

        avg         
--------------------
 2.0000000000000000
(1 row)

 k | concat_agg 
---+------------
 1 | a
 3 | a
 5 | 
 6 | b
 7 | b
 8 | A
(6 rows)

 k | concat_agg 
---+------------
 1 | ba
 3 | Aa
 5 | 
 6 | bab
 7 | b
 8 | A
(6 rows)

 k | bool_and 
---+----------
 1 | t
 3 | f
 5 | f
 6 | t
 7 | t
 8 | f
(6 rows)

 k | bool_or 
---+---------
 1 | t
 3 | t
 5 | f
 6 | t
 7 | t
 8 | f
(6 rows)

 k | count 
---+-------
 1 |     3
 3 |     2
 5 |     1
 6 |     3
 7 |     1
 8 |     1
(6 rows)

 k | count 
---+-------
 1 |     3
 3 |     2
 5 |     1
 6 |     3
 7 |     1
 8 |     1
(6 rows)

 k | max 
---+-----
 1 |   6
 3 |   3
 5 | 9.9
 6 |   6
 7 |   6
 8 |   3
(6 rows)

 k | min 
---+-----
 1 | 1.0
 3 |   2
 5 | 9.9
 6 | 1.0
 7 |   6
 8 |   3
(6 rows)

 k |        pow         
---+--------------------
 1 | 6.0000000000000000
 3 | 27.000000000000000
 5 | 95099.004990000000
 6 | 46656.000000000000
 7 | 279936.00000000000
 8 | 6561.0000000000000
(6 rows)

 k | max 
---+-----
 1 |   6
 3 |   3
 5 | 9.9
 6 |   6
 7 |   6
 8 |   3
(6 rows)

 k | sum  
---+------
 1 | 11.4
 3 |    5
 5 |  9.9
 6 | 11.4
 7 |    6
 8 |    3
(6 rows)

 k |        variance        
---+------------------------
 1 |     6.5200000000000000
 3 | 0.50000000000000000000
 5 |                       
 6 |     6.5200000000000000
 7 |                       
 8 |                       
(6 rows)

 k |         stddev         
---+------------------------
 1 |     2.5534290669607409
 3 | 0.70710678118654752440
 5 |                       
 6 |     2.5534290669607409
 7 |                       
 8 |                       
(6 rows)

 k |         stddev         
---+------------------------
 3 | 0.70710678118654752440
 8 | 0.70710678118654752440
 1 |     2.5534290669607409
 6 |     2.5534290669607409
 7 |     2.5534290669607409
 5 |                       
(6 rows)

 k |  d  | v |         stddev         
---+-----+---+------------------------
 3 |   2 | 4 | 0.70710678118654752440
 8 |   3 | 4 | 0.70710678118654752440
 1 | 1.0 | 2 |     2.5534290669607409
 6 | 4.4 | 2 |     2.5534290669607409
 7 |   6 | 2 |     2.5534290669607409
 5 | 9.9 |   |                       
(6 rows)

 k |        max         
---+--------------------
 1 | 2.5534290669607409
 3 | 2.5534290669607409
 5 | 2.5534290669607409
 6 | 2.5534290669607409
 7 | 2.5534290669607409
 8 | 2.5534290669607409
(6 rows)

 k |        max         
---+--------------------
 1 | 2.5534290669607409
 3 | 2.5534290669607409
 6 | 2.5534290669607409
 7 | 2.5534290669607409
 8 | 2.5534290669607409
 5 |                   
(6 rows)

 k |      ?column?      | w | ?column? | v 
---+--------------------+---+----------+---
 1 | 4.0000000000000000 | 3 |        3 | 2
 3 | 6.0000000000000000 | 5 |        6 | 4
 5 | 7.3333333333333333 | 5 |          |  
 6 | 8.0000000000000000 | 3 |        6 | 2
 7 | 8.6000000000000000 | 2 |        7 | 2
 8 | 9.3333333333333333 | 2 |       10 | 4
(6 rows)

 s | ?column? |      ?column?       | ?column? | v 
---+----------+---------------------+----------+---
 a |        4 | 10.3333333333333333 |      3.0 | 2
 a |        8 | 18.2800000000000000 |        4 | 4
   |       10 | 24.3833333333333333 |     11.9 |  
 b |        9 | 13.6000000000000000 |      6.4 | 2
 b |        9 |  8.0000000000000000 |        8 | 2
 A |       10 |  8.5000000000000000 |        5 | 4
(6 rows)

 k | ?column? | round | round 
---+----------+-------+-------
 1 |        5 |     7 |     3
 3 |        9 |    17 |    10
 5 |          |       |  -319
 6 |        5 |    14 |     8
 7 |        4 |    20 |    14
 8 |        6 |    17 |     7
(6 rows)

 ?column? | ?column? 
----------+----------
        5 |        2
        7 |        2
          |        2
        7 |        4
        8 |        6
       11 |        4
(6 rows)

 big_sum | v_plus_w | small_sum 
---------+----------+-----------
     8.0 |        5 |          
      20 |        9 |       5.0
  -284.2 |          |          
    20.8 |        5 |       6.0
    21.9 |        4 |       7.0
      21 |        6 |      19.9
(6 rows)

 round | ?column? 
-------+----------
     8 |         
     9 |         
       |         
     9 |        7
    10 |         
    12 |       20
(6 rows)

         ?column?          
---------------------------
     -317.0000000000000000
       35.4000000000000000
 -210.60606060606060606060
   85.12727272727272727272
       87.0666666666666665
      107.0000000000000002
(6 rows)

       ?column?       
----------------------
  16.5000000000000000
  32.6666666666666667
 128.4000000000000000
(3 rows)

 k |          avg           |        avg         | row_number |         sum         | row_number |  sum   
---+------------------------+--------------------+------------+---------------------+------------+--------
 1 | 1.00000000000000000000 | 3.3333333333333333 |          3 |                   1 |          1 |   11.9
 3 |     1.5000000000000000 | 3.2800000000000000 |          5 |                   9 |          2 |   24.3
 5 |     4.3000000000000000 | 4.3833333333333333 |          6 |                -312 |          3 | -296.7
 6 |     4.3250000000000000 | 3.6000000000000000 |          4 |              -307.6 |          4 |   16.3
 7 |     4.6600000000000000 | 6.0000000000000000 |          1 | -299.70000000000005 |          5 |    7.9
 8 |     4.3833333333333333 | 4.5000000000000000 |          2 | -296.70000000000005 |          6 |   10.9
(6 rows)

 round 
-------
    43
     7
    41
    70
    59
    53
(6 rows)

        avg         |      ?column?      
--------------------+--------------------
 4.6666666666666667 | 5.6666666666666667
 5.5000000000000000 | 6.5000000000000000
 5.0000000000000000 | 6.0000000000000000
 4.6666666666666667 | 5.6666666666666667
 7.0000000000000000 | 8.0000000000000000
 8.0000000000000000 | 9.0000000000000000
(6 rows)

INSERT 0 3
 k  | row_number 
----+------------
  1 |          1
  3 |          2
  5 |          3
  6 |          4
  7 |          5
  8 |          6
  9 |          7
 10 |          8
 11 |          9
(9 rows)

 k  | v | row_number 
----+---+------------
  1 | 2 |          1
  3 | 4 |          1
  5 |   |          1
  6 | 2 |          2
  7 | 2 |          3
  8 | 4 |          2
  9 | 2 |          4
 10 | 4 |          3
 11 |   |          2
(9 rows)

 k  | v | w | row_number 
----+---+---+------------
  1 | 2 | 3 |          2
  3 | 4 | 5 |          2
  5 |   | 5 |          1
  6 | 2 | 3 |          3
  7 | 2 | 2 |          1
  8 | 4 | 2 |          1
  9 | 2 | 9 |          4
 10 | 4 | 9 |          3
 11 |   | 9 |          2
(9 rows)

 k  | v | w | ?column? 
----+---+---+----------
  1 | 2 | 3 |        3
  3 | 4 | 5 |        3
  5 |   | 5 |         
  6 | 2 | 3 |        4
  7 | 2 | 2 |        3
  8 | 4 | 2 |        5
  9 | 2 | 9 |       -1
 10 | 4 | 9 |        0
 11 |   | 9 |         
(9 rows)

 k  | row_number 
----+------------
  1 |          1
  3 |          1
  5 |          1
  6 |          1
  7 |          1
  8 |          1
  9 |          1
 10 |          1
 11 |          1
(9 rows)

 k  | v | w | ?column? 
----+---+---+----------
  1 | 2 | 3 |        2
  3 | 4 | 5 |        2
  5 |   | 5 |         
  6 | 2 | 3 |        2
  7 | 2 | 2 |        3
  8 | 4 | 2 |        5
  9 | 2 | 9 |       -4
 10 | 4 | 9 |       -2
 11 |   | 9 |         
(9 rows)

        avg         | max | min | ?column? 
--------------------+-----+-----+----------
 6.6666666666666667 |   4 |   2 |        3
(1 row)

 k  | rank 
----+------
  1 |    1
  3 |    1
  5 |    1
  6 |    1
  7 |    1
  8 |    1
  9 |    1
 10 |    1
 11 |    1
(9 rows)

 k  | v | rank 
----+---+------
  1 | 2 |    1
  3 | 4 |    1
  5 |   |    1
  6 | 2 |    1
  7 | 2 |    1
  8 | 4 |    1
  9 | 2 |    1
 10 | 4 |    1
 11 |   |    1
(9 rows)

 k  | v | w | rank 
----+---+---+------
  1 | 2 | 3 |    2
  3 | 4 | 5 |    2
  5 |   | 5 |    1
  6 | 2 | 3 |    2
  7 | 2 | 2 |    1
  8 | 4 | 2 |    1
  9 | 2 | 9 |    4
 10 | 4 | 9 |    3
 11 |   | 9 |    2
(9 rows)

 k  |      ?column?      | k  
----+--------------------+----
  1 | 4.6666666666666667 |  1
  3 | 5.5000000000000000 |  3
  5 | 6.0000000000000000 |  5
  6 | 4.6666666666666667 |  6
  7 | 3.0000000000000000 |  7
  8 | 3.0000000000000000 |  8
  9 | 8.2500000000000000 |  9
 10 | 8.3333333333333333 | 10
 11 | 9.0000000000000000 | 11
(9 rows)

 k  |      ?column?      | k  
----+--------------------+----
  1 | 4.6666666666666667 |  1
  3 | 5.5000000000000000 |  3
  5 | 6.0000000000000000 |  5
  6 | 4.6666666666666667 |  6
  7 | 3.0000000000000000 |  7
  8 | 3.0000000000000000 |  8
  9 | 8.2500000000000000 |  9
 10 | 8.3333333333333333 | 10
 11 | 9.0000000000000000 | 11
(9 rows)

 k  | dense_rank 
----+------------
  1 |          1
  3 |          1
  5 |          1
  6 |          1
  7 |          1
  8 |          1
  9 |          1
 10 |          1
 11 |          1
(9 rows)

 k  | v | dense_rank 
----+---+------------
  1 | 2 |          1
  3 | 4 |          1
  5 |   |          1
  6 | 2 |          1
  7 | 2 |          1
  8 | 4 |          1
  9 | 2 |          1
 10 | 4 |          1
 11 |   |          1
(9 rows)

 k  | v | w | dense_rank 
----+---+---+------------
  1 | 2 | 3 |          2
  3 | 4 | 5 |          2
  5 |   | 5 |          1
  6 | 2 | 3 |          2
  7 | 2 | 2 |          1
  8 | 4 | 2 |          1
  9 | 2 | 9 |          3
 10 | 4 | 9 |          3
 11 |   | 9 |          2
(9 rows)

 k  | percent_rank 
----+--------------
  1 |            0
  3 |            0
  5 |            0
  6 |            0
  7 |            0
  8 |            0
  9 |            0
 10 |            0
 11 |            0
(9 rows)

 k  | v | percent_rank 
----+---+--------------
  1 | 2 |            0
  3 | 4 |            0
  5 |   |            0
  6 | 2 |            0
  7 | 2 |            0
  8 | 4 |            0
  9 | 2 |            0
 10 | 4 |            0
 11 |   |            0
(9 rows)

 k  | v | w |    percent_rank    
----+---+---+--------------------
  1 | 2 | 3 | 0.3333333333333333
  3 | 4 | 5 |                0.5
  5 |   | 5 |                  0
  6 | 2 | 3 | 0.3333333333333333
  7 | 2 | 2 |                  0
  8 | 4 | 2 |                  0
  9 | 2 | 9 |                  1
 10 | 4 | 9 |                  1
 11 |   | 9 |                  1
(9 rows)

 k  | cume_dist 
----+-----------
  1 |         1
  3 |         1
  5 |         1
  6 |         1
  7 |         1
  8 |         1
  9 |         1
 10 |         1
 11 |         1
(9 rows)

 k  | v | cume_dist 
----+---+-----------
  1 | 2 |         1
  3 | 4 |         1
  5 |   |         1
  6 | 2 |         1
  7 | 2 |         1
  8 | 4 |         1
  9 | 2 |         1
 10 | 4 |         1
 11 |   |         1
(9 rows)

 k  | v | w |     cume_dist      
----+---+---+--------------------
  1 | 2 | 3 |               0.75
  3 | 4 | 5 | 0.6666666666666666
  5 |   | 5 |                0.5
  6 | 2 | 3 |               0.75
  7 | 2 | 2 |               0.25
  8 | 4 | 2 | 0.3333333333333333
  9 | 2 | 9 |                  1
 10 | 4 | 9 |                  1
 11 |   | 9 |                  1
(9 rows)

psql:pg_tests/compatible/window.sql:392: ERROR:  argument of ntile must be greater than zero
psql:pg_tests/compatible/window.sql:397: ERROR:  argument of ntile must be greater than zero
 k  | ntile 
----+-------
  1 |      
  3 |      
  5 |      
  6 |      
  7 |      
  8 |      
  9 |      
 10 |      
 11 |      
(9 rows)

 k  | ntile 
----+-------
  1 |     1
  3 |     1
  5 |     1
  6 |     1
  7 |     1
  8 |     1
  9 |     1
 10 |     1
 11 |     1
(9 rows)

 k  | ntile 
----+-------
  1 |     1
  3 |     1
  5 |     1
  6 |     2
  7 |     2
  8 |     3
  9 |     3
 10 |     4
 11 |     4
(9 rows)

 k  | ntile 
----+-------
  1 |     1
  3 |     2
  5 |     3
  6 |     4
  7 |     5
  8 |     6
  9 |     7
 10 |     8
 11 |     9
(9 rows)

 k  | w | ntile 
----+---+-------
  1 | 3 |     1
  3 | 5 |     1
  5 | 5 |     1
  6 | 3 |     2
  7 | 2 |     2
  8 | 2 |     2
  9 | 9 |     3
 10 | 9 |     3
 11 | 9 |     3
(9 rows)

 k  | v | ntile 
----+---+-------
  1 | 2 |     1
  6 | 2 |     1
  7 | 2 |     2
  9 | 2 |     3
  3 | 4 |     1
  8 | 4 |     2
 10 | 4 |     3
  5 |   |     1
 11 |   |     2
(9 rows)

 k  | v | w | ntile 
----+---+---+-------
  7 | 2 | 2 |     1
  1 | 2 | 3 |     2
  6 | 2 | 3 |     3
  9 | 2 | 9 |     4
  8 | 4 | 2 |     1
  3 | 4 | 5 |     2
 10 | 4 | 9 |     3
  5 |   | 5 |     1
 11 |   | 9 |     2
(9 rows)

 k  | w | ntile 
----+---+-------
  1 | 3 |     1
  3 | 5 |     1
  5 | 5 |     1
  6 | 3 |     1
  7 | 2 |     1
  8 | 2 |     1
  9 | 9 |     1
 10 | 9 |     1
 11 | 9 |     1
(9 rows)

 k  | v | ntile 
----+---+-------
  1 | 2 |     1
  6 | 2 |     1
  7 | 2 |     1
  9 | 2 |     1
  3 | 4 |     1
  8 | 4 |     1
 10 | 4 |     1
  5 |   |     1
 11 |   |     1
(9 rows)

 k  | v | w | ntile 
----+---+---+-------
  1 | 2 | 3 |     1
  6 | 2 | 3 |     1
  7 | 2 | 2 |     1
  9 | 2 | 9 |     1
  3 | 4 | 5 |     1
  8 | 4 | 2 |     1
 10 | 4 | 9 |     1
  5 |   | 5 |     1
 11 |   | 9 |     1
(9 rows)

 k  | v | w | ntile 
----+---+---+-------
  7 | 2 | 2 |     1
  8 | 4 | 2 |     2
  1 | 2 | 3 |     1
  6 | 2 | 3 |     2
  3 | 4 | 5 |     1
  5 |   | 5 |     2
  9 | 2 | 9 |     1
 10 | 4 | 9 |     1
 11 |   | 9 |     2
(9 rows)

 k  | v | ntile 
----+---+-------
  1 | 2 |     1
  6 | 2 |     1
  7 | 2 |     1
  9 | 2 |     1
  3 | 4 |     1
  8 | 4 |     2
 10 | 4 |     2
  5 |   |     2
 11 |   |     2
(9 rows)

 k  | v | ntile 
----+---+-------
  7 | 2 |     1
  9 | 2 |     1
  3 | 4 |     1
  8 | 4 |     1
 10 | 4 |     2
  5 |   |     2
 11 |   |     2
(7 rows)

 k  | v | ntile 
----+---+-------
  1 | 2 |     1
  6 | 2 |     1
  7 | 2 |     2
  9 | 2 |     3
  3 | 4 |     1
  8 | 4 |     2
 10 | 4 |     3
  5 |   |     1
 11 |   |     2
(9 rows)

 k  | v | ntile 
----+---+-------
  1 | 2 |     1
  6 | 2 |     1
  7 | 2 |     2
  9 | 2 |     3
  3 | 4 |     1
  8 | 4 |     2
 10 | 4 |     3
  5 |   |     1
 11 |   |     2
(9 rows)

 k  | w | ntile 
----+---+-------
  1 | 3 |     1
  3 | 5 |     1
  5 | 5 |     1
  6 | 3 |     2
  7 | 2 |     2
  8 | 2 |     2
  9 | 9 |     3
 10 | 9 |     3
 11 | 9 |     3
(9 rows)

 k  | ntile 
----+-------
  1 |     1
  3 |     1
  5 |     1
  6 |     1
  7 |     1
  8 |     1
  9 |     1
 10 |     1
 11 |     1
(9 rows)

 k  | lag 
----+-----
  1 |    
  3 |   9
  5 |   9
  6 |   9
  7 |   9
  8 |   9
  9 |   9
 10 |   9
 11 |   9
(9 rows)

 k  | lead 
----+------
  1 |    9
  3 |    9
  5 |    9
  6 |    9
  7 |    9
  8 |    9
  9 |    9
 10 |    9
 11 |     
(9 rows)

 k  | lag 
----+-----
  1 |    
  3 |   1
  5 |   3
  6 |   5
  7 |   6
  8 |   7
  9 |   8
 10 |   9
 11 |  10
(9 rows)

 k  | lag 
----+-----
  1 |   7
  3 |   8
  5 |    
  6 |   1
  7 |    
  8 |    
  9 |   6
 10 |   3
 11 |   5
(9 rows)

 k  | lead 
----+------
  1 |    3
  3 |    5
  5 |    6
  6 |    7
  7 |    8
  8 |    9
  9 |   10
 10 |   11
 11 |     
(9 rows)

 k  | lead 
----+------
  1 |    6
  3 |   10
  5 |   11
  6 |    9
  7 |    1
  8 |    3
  9 |     
 10 |     
 11 |     
(9 rows)

 k  | lag 
----+-----
  1 |    
  3 |    
  5 |    
  6 |   1
  7 |   3
  8 |   5
  9 |   6
 10 |   7
 11 |   8
(9 rows)

 k  | lag 
----+-----
  1 |    
  3 |    
  5 |    
  6 |    
  7 |    
  8 |    
  9 |   7
 10 |    
 11 |    
(9 rows)

 k  | lead 
----+------
  1 |    6
  3 |    7
  5 |    8
  6 |    9
  7 |   10
  8 |   11
  9 |     
 10 |     
 11 |     
(9 rows)

 k  | lead 
----+------
  1 |     
  3 |     
  5 |     
  6 |     
  7 |    9
  8 |     
  9 |     
 10 |     
 11 |     
(9 rows)

 k  | lag 
----+-----
  1 |   8
  3 |   9
  5 |  10
  6 |  11
  7 |    
  8 |    
  9 |    
 10 |    
 11 |    
(9 rows)

 k  | lead 
----+------
  1 |     
  3 |     
  5 |     
  6 |     
  7 |     
  8 |    1
  9 |    3
 10 |    5
 11 |    6
(9 rows)

 k  | lag 
----+-----
  1 |   1
  3 |   3
  5 |   5
  6 |   6
  7 |   7
  8 |   8
  9 |   9
 10 |  10
 11 |  11
(9 rows)

 k  | lead 
----+------
  1 |    1
  3 |    3
  5 |    5
  6 |    6
  7 |    7
  8 |    8
  9 |    9
 10 |   10
 11 |   11
(9 rows)

 k  | lag 
----+-----
  1 |    
  3 |    
  5 |    
  6 |    
  7 |    
  8 |    
  9 |    
 10 |    
 11 |    
(9 rows)

 k  | lead 
----+------
  1 |     
  3 |     
  5 |     
  6 |     
  7 |     
  8 |     
  9 |     
 10 |     
 11 |     
(9 rows)

 k  | lag 
----+-----
  1 |    
  3 |    
  5 |    
  6 |   1
  7 |   5
  8 |   6
  9 |    
 10 |    
 11 |    
(9 rows)

 k  | lag 
----+-----
  1 |    
  3 |    
  5 |    
  6 |    
  7 |    
  8 |    
  9 |    
 10 |    
 11 |    
(9 rows)

 k  | lead 
----+------
  1 |    6
  3 |    9
  5 |   10
  6 |    9
  7 |    9
  8 |   10
  9 |     
 10 |     
 11 |     
(9 rows)

 k  | lead 
----+------
  1 |     
  3 |     
  5 |     
  6 |     
  7 |    6
  8 |   10
  9 |     
 10 |     
 11 |     
(9 rows)

 k  | lead 
----+------
  1 |    6
  3 |    7
  5 |    8
  6 |    9
  7 |   10
  8 |   11
  9 |  -99
 10 |  -99
 11 |  -99
(9 rows)

 k  | lag 
----+-----
  1 |   2
  3 |   4
  5 |    
  6 |   1
  7 |   3
  8 |   5
  9 |   6
 10 |   7
 11 |   8
(9 rows)

 k  | lead 
----+------
  1 |    6
  3 |    7
  5 |    8
  6 |    9
  7 |   10
  8 |   11
  9 |    2
 10 |    4
 11 |     
(9 rows)

 k  | ?column? 
----+----------
  1 |        9
  3 |       12
  5 |       13
  6 |       12
  7 |       12
  8 |       12
  9 |        5
 10 |        9
 11 |         
(9 rows)

 k  | lag 
----+-----
  1 |    
  3 |    
  5 |    
  6 |    
  7 |    
  8 |    
  9 |    
 10 |    
 11 |    
(9 rows)

 k  | lead 
----+------
  1 |     
  3 |     
  5 |     
  6 |     
  7 |     
  8 |     
  9 |     
 10 |     
 11 |     
(9 rows)

 k  | lag 
----+-----
  1 |   1
  3 |   3
  5 |   5
  6 |   6
  7 |   7
  8 |   8
  9 |   9
 10 |  10
 11 |  11
(9 rows)

 k  | lead 
----+------
  1 |    1
  3 |    3
  5 |    5
  6 |    6
  7 |    7
  8 |    8
  9 |    9
 10 |   10
 11 |   11
(9 rows)

 k  | lag 
----+-----
  1 |    
  3 |    
  5 |    
  6 |    
  7 |    
  8 |    
  9 |    
 10 |    
 11 |    
(9 rows)

 k  | lead 
----+------
  1 |     
  3 |     
  5 |     
  6 |     
  7 |     
  8 |     
  9 |     
 10 |     
 11 |     
(9 rows)

 k  | lag 
----+-----
  1 |   1
  3 |   3
  5 |   5
  6 |   6
  7 |   7
  8 |   8
  9 |   9
 10 |  10
 11 |  11
(9 rows)

 k  | lead 
----+------
  1 |    1
  3 |    3
  5 |    5
  6 |    6
  7 |    7
  8 |    8
  9 |    9
 10 |   10
 11 |   11
(9 rows)

 k  | lag 
----+-----
  1 | -99
  3 | -99
  5 | -99
  6 | -99
  7 | -99
  8 | -99
  9 | -99
 10 | -99
 11 | -99
(9 rows)

 k  | lead 
----+------
  1 |  -99
  3 |  -99
  5 |  -99
  6 |  -99
  7 |  -99
  8 |  -99
  9 |  -99
 10 |  -99
 11 |  -99
(9 rows)

 k  | lag 
----+-----
  1 |   2
  3 |   4
  5 |    
  6 |   2
  7 |   2
  8 |   4
  9 |   2
 10 |   4
 11 |    
(9 rows)

 k  | lead 
----+------
  1 |    2
  3 |    4
  5 |     
  6 |    2
  7 |    2
  8 |    4
  9 |    2
 10 |    4
 11 |     
(9 rows)

 k  | first_value 
----+-------------
  1 |            
  3 |            
  5 |            
  6 |            
  7 |            
  8 |            
  9 |            
 10 |            
 11 |            
(9 rows)

 k  | first_value 
----+-------------
  1 |           1
  3 |           1
  5 |           1
  6 |           1
  7 |           1
  8 |           1
  9 |           1
 10 |           1
 11 |           1
(9 rows)

 k  | first_value 
----+-------------
  1 |     4657.67
  3 |     4657.67
  5 |     4657.67
  6 |     4657.67
  7 |     4657.67
  8 |     4657.67
  9 |     4657.67
 10 |     4657.67
 11 |     4657.67
(9 rows)

 k  | first_value 
----+-------------
  1 |           2
  3 |           2
  5 |           2
  6 |           2
  7 |           2
  8 |           2
  9 |           2
 10 |           2
 11 |           2
(9 rows)

 k  | v | w | first_value 
----+---+---+-------------
  1 | 2 | 3 |           2
  3 | 4 | 5 |           2
  5 |   | 5 |           5
  6 | 2 | 3 |           2
  7 | 2 | 2 |           2
  8 | 4 | 2 |           2
  9 | 2 | 9 |           2
 10 | 4 | 9 |           2
 11 |   | 9 |           5
(9 rows)

 k  | v | w | first_value 
----+---+---+-------------
  1 | 2 | 3 |           9
  3 | 4 | 5 |           9
  5 |   | 5 |           9
  6 | 2 | 3 |           9
  7 | 2 | 2 |           9
  8 | 4 | 2 |           9
  9 | 2 | 9 |           9
 10 | 4 | 9 |           9
 11 |   | 9 |           9
(9 rows)

 k  | first_value 
----+-------------
  1 |           2
  3 |           4
  5 |            
  6 |           2
  7 |           2
  8 |           4
  9 |           2
 10 |           4
 11 |            
(9 rows)

 k  | last_value 
----+------------
  1 |           
  3 |           
  5 |           
  6 |           
  7 |           
  8 |           
  9 |           
 10 |           
 11 |           
(9 rows)

 k  | last_value 
----+------------
  1 |          1
  3 |          1
  5 |          1
  6 |          1
  7 |          1
  8 |          1
  9 |          1
 10 |          1
 11 |          1
(9 rows)

 k  | last_value 
----+------------
  1 |    4657.67
  3 |    4657.67
  5 |    4657.67
  6 |    4657.67
  7 |    4657.67
  8 |    4657.67
  9 |    4657.67
 10 |    4657.67
 11 |    4657.67
(9 rows)

 k  | last_value 
----+------------
  1 |          2
  3 |          4
  5 |           
  6 |          2
  7 |          2
  8 |          4
  9 |          2
 10 |          4
 11 |           
(9 rows)

 k  | v | w | last_value 
----+---+---+------------
  1 | 2 | 3 |          3
  3 | 4 | 5 |          5
  5 |   | 5 |          5
  6 | 2 | 3 |          3
  7 | 2 | 2 |          2
  8 | 4 | 2 |          2
  9 | 2 | 9 |          9
 10 | 4 | 9 |          9
 11 |   | 9 |          9
(9 rows)

 k  | v | w | last_value 
----+---+---+------------
  1 | 2 | 3 |          3
  3 | 4 | 5 |          5
  5 |   | 5 |          5
  6 | 2 | 3 |          3
  7 | 2 | 2 |          2
  8 | 4 | 2 |          2
  9 | 2 | 9 |          9
 10 | 4 | 9 |          9
 11 |   | 9 |          9
(9 rows)

 k  | last_value 
----+------------
  1 |          2
  3 |          4
  5 |           
  6 |          2
  7 |          2
  8 |          4
  9 |          2
 10 |          4
 11 |           
(9 rows)

psql:pg_tests/compatible/window.sql:605: ERROR:  invalid input syntax for type integer: "FOO"
LINE 1: SELECT k, nth_value(v, 'FOO') OVER () FROM kv ORDER BY 1;
                               ^
psql:pg_tests/compatible/window.sql:610: ERROR:  argument of nth_value must be greater than zero
psql:pg_tests/compatible/window.sql:615: ERROR:  argument of nth_value must be greater than zero
 k  | nth_value 
----+-----------
  1 |          
  3 |          
  5 |          
  6 |          
  7 |          
  8 |          
  9 |          
 10 |          
 11 |          
(9 rows)

 k  | nth_value 
----+-----------
  1 |         1
  3 |         1
  5 |         1
  6 |         1
  7 |         1
  8 |         1
  9 |         1
 10 |         1
 11 |         1
(9 rows)

 k  | nth_value 
----+-----------
  1 |          
  3 |          
  5 |          
  6 |          
  7 |          
  8 |          
  9 |          
 10 |          
 11 |          
(9 rows)

 k  | nth_value 
----+-----------
  1 |   4657.67
  3 |   4657.67
  5 |   4657.67
  6 |   4657.67
  7 |   4657.67
  8 |   4657.67
  9 |   4657.67
 10 |   4657.67
 11 |   4657.67
(9 rows)

 k  | nth_value 
----+-----------
  1 |          
  3 |          
  5 |          
  6 |          
  7 |          
  8 |          
  9 |          
 10 |         4
 11 |         4
(9 rows)

 k  | v | w | nth_value 
----+---+---+-----------
  1 | 2 | 3 |         3
  3 | 4 | 5 |         5
  5 |   | 5 |          
  6 | 2 | 3 |         3
  7 | 2 | 2 |          
  8 | 4 | 2 |          
  9 | 2 | 9 |         3
 10 | 4 | 9 |         5
 11 |   | 9 |         9
(9 rows)

 k  | v | w | nth_value 
----+---+---+-----------
  1 | 2 | 3 |         3
  3 | 4 | 5 |         5
  5 |   | 5 |         5
  6 | 2 | 3 |         3
  7 | 2 | 2 |         3
  8 | 4 | 2 |         5
  9 | 2 | 9 |          
 10 | 4 | 9 |          
 11 |   | 9 |          
(9 rows)

 k  | nth_value 
----+-----------
  1 |         2
  3 |          
  5 |          
  6 |          
  7 |          
  8 |          
  9 |          
 10 |          
 11 |          
(9 rows)

 k  | nth_value 
----+-----------
  1 |          
  3 |          
  5 |          
  6 |         4
  7 |         4
  8 |         2
  9 |         4
 10 |         2
 11 |          
(9 rows)

 k  | nth_value 
----+-----------
  1 |         2
  3 |         4
  5 |          
  6 |         2
  7 |         2
  8 |         4
  9 |         2
 10 |         4
 11 |          
(9 rows)

 k  | nth_value 
----+-----------
  1 |          
  3 |          
  5 |          
  6 |          
  7 |          
  8 |          
  9 |          
 10 |          
 11 |          
(9 rows)

INSERT 0 1
psql:pg_tests/compatible/window.sql:657: ERROR:  argument of nth_value must be greater than zero
DELETE 1
psql:pg_tests/compatible/window.sql:665: ERROR:  FILTER is not implemented for non-aggregate window functions
LINE 1: SELECT k, rank() FILTER (WHERE k=1) OVER () FROM kv;
                  ^
      i       |             avg             
--------------+-----------------------------
 00:00:00.001 | 00:00:00.001
 00:00:02     | 00:00:01.0005
 00:01:00     | 00:00:20.667
 4 days       | 1 day 00:00:15.50025
 3 years      | 7 mons 6 days 19:12:12.4002
              | 7 mons 6 days 19:12:12.4002
              | 7 mons 6 days 19:12:12.4002
              | 7 mons 6 days 19:12:12.4002
              | 7 mons 6 days 19:12:12.4002
(9 rows)

 ?column? 
----------
        1
(1 row)

 ?column? 
----------
        0
(1 row)

 ?column? 
----------
        0
(1 row)

CREATE TABLE
INSERT 0 11
          avg          
-----------------------
  200.0000000000000000
  300.0000000000000000
  450.0000000000000000
  700.0000000000000000
 1050.0000000000000000
  950.0000000000000000
  700.0000000000000000
  750.0000000000000000
  750.0000000000000000
  425.0000000000000000
  175.0000000000000000
(11 rows)

          avg          
-----------------------
  150.0000000000000000
  175.0000000000000000
  200.0000000000000000
  300.0000000000000000
  450.0000000000000000
  600.0000000000000000
  700.0000000000000000
  700.0000000000000000
  750.0000000000000000
  850.0000000000000000
 1050.0000000000000000
(11 rows)

psql:pg_tests/compatible/window.sql:721: ERROR:  frame starting offset must not be null
psql:pg_tests/compatible/window.sql:727: ERROR:  frame starting offset must not be null
psql:pg_tests/compatible/window.sql:733: ERROR:  frame starting offset must not be negative
psql:pg_tests/compatible/window.sql:739: ERROR:  frame starting offset must not be negative
psql:pg_tests/compatible/window.sql:745: ERROR:  frame ending offset must not be null
psql:pg_tests/compatible/window.sql:751: ERROR:  frame ending offset must not be negative
psql:pg_tests/compatible/window.sql:757: ERROR:  frame ending offset must not be negative
psql:pg_tests/compatible/window.sql:763: ERROR:  frame ending offset must not be negative
       avg_price       
-----------------------
 1200.0000000000000000
  950.0000000000000000
  866.6666666666666667
  733.3333333333333333
  200.0000000000000000
  300.0000000000000000
  366.6666666666666667
  600.0000000000000000
  700.0000000000000000
  425.0000000000000000
  350.0000000000000000
(11 rows)

       avg_price       
-----------------------
 1200.0000000000000000
  950.0000000000000000
  866.6666666666666667
  733.3333333333333333
  200.0000000000000000
  300.0000000000000000
  366.6666666666666667
  600.0000000000000000
  700.0000000000000000
  425.0000000000000000
  350.0000000000000000
(11 rows)

      avg_price       
----------------------
 850.0000000000000000
 850.0000000000000000
 850.0000000000000000
 733.3333333333333333
 500.0000000000000000
 500.0000000000000000
 500.0000000000000000
 600.0000000000000000
 350.0000000000000000
 350.0000000000000000
 350.0000000000000000
(11 rows)

      avg_price       
----------------------
 850.0000000000000000
 850.0000000000000000
 850.0000000000000000
 733.3333333333333333
 500.0000000000000000
 500.0000000000000000
 500.0000000000000000
 600.0000000000000000
 350.0000000000000000
 350.0000000000000000
 350.0000000000000000
(11 rows)

      avg_price       
----------------------
 866.6666666666666667
 850.0000000000000000
 850.0000000000000000
 850.0000000000000000
 366.6666666666666667
 500.0000000000000000
 500.0000000000000000
 500.0000000000000000
 350.0000000000000000
 350.0000000000000000
 350.0000000000000000
(11 rows)

      avg_price       
----------------------
 866.6666666666666667
 850.0000000000000000
 850.0000000000000000
 850.0000000000000000
 366.6666666666666667
 500.0000000000000000
 500.0000000000000000
 500.0000000000000000
 350.0000000000000000
 350.0000000000000000
 350.0000000000000000
(11 rows)

  product_name   | price  |      first      
-----------------+--------+-----------------
 Microsoft Lumia | 200.00 | Microsoft Lumia
 Samsung         | 200.00 | Microsoft Lumia
 Lenovo Thinkpad | 700.00 | Lenovo Thinkpad
 Sony VAIO       | 700.00 | Lenovo Thinkpad
 iPad            | 700.00 | Lenovo Thinkpad
(5 rows)

  product_name   | price  |  last   
-----------------+--------+---------
 Microsoft Lumia | 200.00 | Samsung
 Samsung         | 200.00 | Samsung
 Lenovo Thinkpad | 700.00 | iPad
 Sony VAIO       | 700.00 | iPad
 iPad            | 700.00 | iPad
(5 rows)

  product_name   | price  |  second   
-----------------+--------+-----------
 Microsoft Lumia | 200.00 | Samsung
 Samsung         | 200.00 | 
 Lenovo Thinkpad | 700.00 | Sony VAIO
 Sony VAIO       | 700.00 | iPad
 iPad            | 700.00 | 
(5 rows)

  product_name   | group_name |  price  |     avg_of_three      
-----------------+------------+---------+-----------------------
 Lenovo Thinkpad | Laptop     |  700.00 |  700.0000000000000000
 Sony VAIO       | Laptop     |  700.00 |  733.3333333333333333
 Dell            | Laptop     |  800.00 |  900.0000000000000000
 HP Elite        | Laptop     | 1200.00 | 1000.0000000000000000
 Microsoft Lumia | Smartphone |  200.00 |  300.0000000000000000
 HTC One         | Smartphone |  400.00 |  366.6666666666666667
 Nexus           | Smartphone |  500.00 |  600.0000000000000000
 iPhone          | Smartphone |  900.00 |  700.0000000000000000
 Kindle Fire     | Tablet     |  150.00 |  175.0000000000000000
 Samsung         | Tablet     |  200.00 |  350.0000000000000000
 iPad            | Tablet     |  700.00 |  450.0000000000000000
(11 rows)

  product_name   | group_name |  price  | avg_of_three_floats 
-----------------+------------+---------+---------------------
 Lenovo Thinkpad | Laptop     |  700.00 |                 700
 Sony VAIO       | Laptop     |  700.00 |   733.3333333333334
 Dell            | Laptop     |  800.00 |                 900
 HP Elite        | Laptop     | 1200.00 |                1000
 Microsoft Lumia | Smartphone |  200.00 |                 300
 HTC One         | Smartphone |  400.00 |   366.6666666666667
 Nexus           | Smartphone |  500.00 |                 600
 iPhone          | Smartphone |  900.00 |                 700
 Kindle Fire     | Tablet     |  150.00 |                 175
 Samsung         | Tablet     |  200.00 |                 350
 iPad            | Tablet     |  700.00 |                 450
(11 rows)

  product_name   | group_name |  price  |   avg_of_three_ints   
-----------------+------------+---------+-----------------------
 Lenovo Thinkpad | Laptop     |  700.00 |  700.0000000000000000
 Sony VAIO       | Laptop     |  700.00 |  733.3333333333333333
 Dell            | Laptop     |  800.00 |  900.0000000000000000
 HP Elite        | Laptop     | 1200.00 | 1000.0000000000000000
 Microsoft Lumia | Smartphone |  200.00 |  300.0000000000000000
 HTC One         | Smartphone |  400.00 |  366.6666666666666667
 Nexus           | Smartphone |  500.00 |  600.0000000000000000
 iPhone          | Smartphone |  900.00 |  700.0000000000000000
 Kindle Fire     | Tablet     |  150.00 |  175.0000000000000000
 Samsung         | Tablet     |  200.00 |  350.0000000000000000
 iPad            | Tablet     |  700.00 |  450.0000000000000000
(11 rows)

 group_name |  product_name   |  price  | running_avg_of_three  
------------+-----------------+---------+-----------------------
 Smartphone | Microsoft Lumia |  200.00 |  200.0000000000000000
 Smartphone | HTC One         |  400.00 |  300.0000000000000000
 Smartphone | Nexus           |  500.00 |  366.6666666666666667
 Smartphone | iPhone          |  900.00 |  600.0000000000000000
 Laptop     | HP Elite        | 1200.00 | 1200.0000000000000000
 Laptop     | Lenovo Thinkpad |  700.00 |  950.0000000000000000
 Laptop     | Sony VAIO       |  700.00 |  866.6666666666666667
 Laptop     | Dell            |  800.00 |  733.3333333333333333
 Tablet     | iPad            |  700.00 |  700.0000000000000000
 Tablet     | Kindle Fire     |  150.00 |  425.0000000000000000
 Tablet     | Samsung         |  200.00 |  350.0000000000000000
(11 rows)

 group_name |  product_name   |  price  | running_sum 
------------+-----------------+---------+-------------
 Smartphone | Microsoft Lumia |  200.00 |      200.00
 Smartphone | HTC One         |  400.00 |      600.00
 Smartphone | Nexus           |  500.00 |     1100.00
 Smartphone | iPhone          |  900.00 |     1800.00
 Laptop     | HP Elite        | 1200.00 |     1200.00
 Laptop     | Lenovo Thinkpad |  700.00 |     1900.00
 Laptop     | Sony VAIO       |  700.00 |     2600.00
 Laptop     | Dell            |  800.00 |     2200.00
 Tablet     | iPad            |  700.00 |      700.00
 Tablet     | Kindle Fire     |  150.00 |      850.00
 Tablet     | Samsung         |  200.00 |     1050.00
(11 rows)

 group_name |  product_name   |  price  |        array_agg_price         
------------+-----------------+---------+--------------------------------
 Smartphone | Microsoft Lumia |  200.00 | {200.00,400.00,500.00}
 Smartphone | HTC One         |  400.00 | {200.00,400.00,500.00,900.00}
 Smartphone | Nexus           |  500.00 | {400.00,500.00,900.00}
 Smartphone | iPhone          |  900.00 | {500.00,900.00}
 Laptop     | HP Elite        | 1200.00 | {1200.00,700.00,700.00}
 Laptop     | Lenovo Thinkpad |  700.00 | {1200.00,700.00,700.00,800.00}
 Laptop     | Sony VAIO       |  700.00 | {700.00,700.00,800.00}
 Laptop     | Dell            |  800.00 | {700.00,800.00}
 Tablet     | iPad            |  700.00 | {700.00,150.00,200.00}
 Tablet     | Kindle Fire     |  150.00 | {700.00,150.00,200.00}
 Tablet     | Samsung         |  200.00 | {150.00,200.00}
(11 rows)

 group_name |  product_name   |  price  |           array_agg            |           array_agg            |           array_agg            |           array_agg            
------------+-----------------+---------+--------------------------------+--------------------------------+--------------------------------+--------------------------------
 Smartphone | Microsoft Lumia |  200.00 | {900.00,500.00,400.00,200.00}  | {900.00,500.00,400.00,200.00}  | {900.00,500.00,400.00,200.00}  | {900.00,500.00,400.00,200.00}
 Smartphone | HTC One         |  400.00 | {900.00,500.00,400.00,200.00}  | {900.00,500.00,400.00,200.00}  | {900.00,500.00,400.00,200.00}  | {900.00,500.00,400.00,200.00}
 Smartphone | Nexus           |  500.00 | {900.00,500.00,400.00,200.00}  | {900.00,500.00,400.00,200.00}  | {900.00,500.00,400.00,200.00}  | {900.00,500.00,400.00,200.00}
 Smartphone | iPhone          |  900.00 | {900.00,500.00,400.00,200.00}  | {900.00,500.00,400.00,200.00}  | {900.00,500.00,400.00,200.00}  | {900.00,500.00,400.00,200.00}
 Laptop     | HP Elite        | 1200.00 | {800.00,700.00,700.00,1200.00} | {800.00,700.00,700.00,1200.00} | {800.00,700.00,700.00,1200.00} | {800.00,700.00,700.00,1200.00}
 Laptop     | Lenovo Thinkpad |  700.00 | {800.00,700.00,700.00,1200.00} | {800.00,700.00,700.00,1200.00} | {800.00,700.00,700.00,1200.00} | {800.00,700.00,700.00,1200.00}
 Laptop     | Sony VAIO       |  700.00 | {800.00,700.00,700.00,1200.00} | {800.00,700.00,700.00,1200.00} | {800.00,700.00,700.00,1200.00} | {800.00,700.00,700.00,1200.00}
 Laptop     | Dell            |  800.00 | {800.00,700.00,700.00,1200.00} | {800.00,700.00,700.00,1200.00} | {800.00,700.00,700.00,1200.00} | {800.00,700.00,700.00,1200.00}
 Tablet     | iPad            |  700.00 | {200.00,150.00,700.00}         | {200.00,150.00,700.00}         | {200.00,150.00,700.00}         | {200.00,150.00,700.00}
 Tablet     | Kindle Fire     |  150.00 | {200.00,150.00,700.00}         | {200.00,150.00,700.00}         | {200.00,150.00,700.00}         | {200.00,150.00,700.00}
 Tablet     | Samsung         |  200.00 | {200.00,150.00,700.00}         | {200.00,150.00,700.00}         | {200.00,150.00,700.00}         | {200.00,150.00,700.00}
(11 rows)

 group_name |  product_name   |  price  |      avg_price       
------------+-----------------+---------+----------------------
 Smartphone | Microsoft Lumia |  200.00 | 500.0000000000000000
 Smartphone | HTC One         |  400.00 | 500.0000000000000000
 Smartphone | Nexus           |  500.00 | 500.0000000000000000
 Smartphone | iPhone          |  900.00 | 500.0000000000000000
 Laptop     | HP Elite        | 1200.00 | 850.0000000000000000
 Laptop     | Lenovo Thinkpad |  700.00 | 850.0000000000000000
 Laptop     | Sony VAIO       |  700.00 | 850.0000000000000000
 Laptop     | Dell            |  800.00 | 850.0000000000000000
 Tablet     | iPad            |  700.00 | 350.0000000000000000
 Tablet     | Kindle Fire     |  150.00 | 350.0000000000000000
 Tablet     | Samsung         |  200.00 | 350.0000000000000000
(11 rows)

 group_name |  product_name   |  price  | min_over_empty_frame 
------------+-----------------+---------+----------------------
 Smartphone | Microsoft Lumia |  200.00 |                     
 Smartphone | HTC One         |  400.00 |                     
 Smartphone | Nexus           |  500.00 |                     
 Smartphone | iPhone          |  900.00 |                     
 Laptop     | HP Elite        | 1200.00 |                     
 Laptop     | Lenovo Thinkpad |  700.00 |                     
 Laptop     | Sony VAIO       |  700.00 |                     
 Laptop     | Dell            |  800.00 |                     
 Tablet     | iPad            |  700.00 |                     
 Tablet     | Kindle Fire     |  150.00 |                     
 Tablet     | Samsung         |  200.00 |                     
(11 rows)

  product_name   |  price  | min_over_three | max_over_partition 
-----------------+---------+----------------+--------------------
 Microsoft Lumia |  200.00 |         200.00 |             900.00
 HTC One         |  400.00 |         200.00 |             900.00
 Nexus           |  500.00 |         400.00 |             900.00
 iPhone          |  900.00 |         500.00 |             900.00
 HP Elite        | 1200.00 |         700.00 |            1200.00
 Lenovo Thinkpad |  700.00 |         700.00 |            1200.00
 Sony VAIO       |  700.00 |         700.00 |            1200.00
 Dell            |  800.00 |         700.00 |            1200.00
 iPad            |  700.00 |         150.00 |             700.00
 Kindle Fire     |  150.00 |         150.00 |             700.00
 Samsung         |  200.00 |         150.00 |             700.00
(11 rows)

 group_name |  product_name   |  price  | min_over_single_row 
------------+-----------------+---------+---------------------
 Smartphone | Microsoft Lumia |  200.00 |              200.00
 Smartphone | HTC One         |  400.00 |              400.00
 Smartphone | Nexus           |  500.00 |              500.00
 Smartphone | iPhone          |  900.00 |              900.00
 Laptop     | HP Elite        | 1200.00 |             1200.00
 Laptop     | Lenovo Thinkpad |  700.00 |              700.00
 Laptop     | Sony VAIO       |  700.00 |              700.00
 Laptop     | Dell            |  800.00 |              800.00
 Tablet     | iPad            |  700.00 |              700.00
 Tablet     | Kindle Fire     |  150.00 |              150.00
 Tablet     | Samsung         |  200.00 |              200.00
(11 rows)

 group_name |  product_name   |  price  |     running_avg      
------------+-----------------+---------+----------------------
 Smartphone | Microsoft Lumia |  200.00 | 600.0000000000000000
 Smartphone | HTC One         |  400.00 | 700.0000000000000000
 Smartphone | Nexus           |  500.00 | 900.0000000000000000
 Smartphone | iPhone          |  900.00 |                     
 Laptop     | HP Elite        | 1200.00 | 733.3333333333333333
 Laptop     | Lenovo Thinkpad |  700.00 | 750.0000000000000000
 Laptop     | Sony VAIO       |  700.00 | 800.0000000000000000
 Laptop     | Dell            |  800.00 |                     
 Tablet     | iPad            |  700.00 | 175.0000000000000000
 Tablet     | Kindle Fire     |  150.00 | 200.0000000000000000
 Tablet     | Samsung         |  200.00 |                     
(11 rows)

  product_name   |  price  |   min   |   max   |   sum   |          avg          
-----------------+---------+---------+---------+---------+-----------------------
 Microsoft Lumia |  200.00 |  200.00 |  400.00 | 2000.00 |  200.0000000000000000
 HTC One         |  400.00 |  200.00 |  500.00 | 2000.00 |  400.0000000000000000
 Nexus           |  500.00 |  200.00 |  900.00 | 1800.00 |  500.0000000000000000
 iPhone          |  900.00 |  200.00 |  900.00 | 1400.00 |  900.0000000000000000
 HP Elite        | 1200.00 | 1200.00 | 1200.00 | 3400.00 | 1200.0000000000000000
 Lenovo Thinkpad |  700.00 |  700.00 | 1200.00 | 3400.00 |  700.0000000000000000
 Sony VAIO       |  700.00 |  700.00 | 1200.00 | 2200.00 |  700.0000000000000000
 Dell            |  800.00 |  700.00 | 1200.00 | 1500.00 |  800.0000000000000000
 iPad            |  700.00 |  700.00 |  700.00 | 1050.00 |  700.0000000000000000
 Kindle Fire     |  150.00 |  150.00 |  700.00 | 1050.00 |  150.0000000000000000
 Samsung         |  200.00 |  150.00 |  700.00 |  350.00 |  200.0000000000000000
(11 rows)

         avg          |          avg          |         avg          
----------------------+-----------------------+----------------------
 300.0000000000000000 |  200.0000000000000000 | 300.0000000000000000
 366.6666666666666667 |  300.0000000000000000 | 366.6666666666666667
 600.0000000000000000 |  450.0000000000000000 | 600.0000000000000000
 700.0000000000000000 |  700.0000000000000000 | 700.0000000000000000
 950.0000000000000000 | 1050.0000000000000000 | 950.0000000000000000
 866.6666666666666667 |  950.0000000000000000 | 866.6666666666666667
 733.3333333333333333 |  700.0000000000000000 | 733.3333333333333333
 750.0000000000000000 |  750.0000000000000000 | 750.0000000000000000
 425.0000000000000000 |  750.0000000000000000 | 425.0000000000000000
 350.0000000000000000 |  425.0000000000000000 | 350.0000000000000000
 175.0000000000000000 |  175.0000000000000000 | 175.0000000000000000
(11 rows)

 group_name |  product_name   |  price  |   sum   
------------+-----------------+---------+---------
 Smartphone | Microsoft Lumia |  200.00 | 6450.00
 Smartphone | HTC One         |  400.00 | 6450.00
 Smartphone | Nexus           |  500.00 | 6450.00
 Smartphone | iPhone          |  900.00 | 6450.00
 Laptop     | HP Elite        | 1200.00 | 6450.00
 Laptop     | Lenovo Thinkpad |  700.00 | 6450.00
 Laptop     | Sony VAIO       |  700.00 | 6450.00
 Laptop     | Dell            |  800.00 | 6450.00
 Tablet     | iPad            |  700.00 | 6450.00
 Tablet     | Kindle Fire     |  150.00 | 6450.00
 Tablet     | Samsung         |  200.00 | 6450.00
(11 rows)

 group_name |  product_name   |  price  |   sum   
------------+-----------------+---------+---------
 Smartphone | Microsoft Lumia |  200.00 | 6450.00
 Smartphone | HTC One         |  400.00 | 6450.00
 Smartphone | Nexus           |  500.00 | 6450.00
 Smartphone | iPhone          |  900.00 | 6450.00
 Laptop     | HP Elite        | 1200.00 | 6450.00
 Laptop     | Lenovo Thinkpad |  700.00 | 6450.00
 Laptop     | Sony VAIO       |  700.00 | 6450.00
 Laptop     | Dell            |  800.00 | 6450.00
 Tablet     | iPad            |  700.00 | 6450.00
 Tablet     | Kindle Fire     |  150.00 | 6450.00
 Tablet     | Samsung         |  200.00 | 6450.00
(11 rows)

 group_name |  product_name   |  price  |   sum   
------------+-----------------+---------+---------
 Smartphone | Microsoft Lumia |  200.00 | 6450.00
 Smartphone | HTC One         |  400.00 | 6450.00
 Smartphone | Nexus           |  500.00 | 6450.00
 Smartphone | iPhone          |  900.00 | 6450.00
 Laptop     | HP Elite        | 1200.00 | 6450.00
 Laptop     | Lenovo Thinkpad |  700.00 | 6450.00
 Laptop     | Sony VAIO       |  700.00 | 6450.00
 Laptop     | Dell            |  800.00 | 6450.00
 Tablet     | iPad            |  700.00 | 6450.00
 Tablet     | Kindle Fire     |  150.00 | 6450.00
 Tablet     | Samsung         |  200.00 | 6450.00
(11 rows)

 group_name |  product_name   |  price  |   sum   
------------+-----------------+---------+---------
 Smartphone | Microsoft Lumia |  200.00 | 6450.00
 Smartphone | HTC One         |  400.00 | 6450.00
 Smartphone | Nexus           |  500.00 | 6450.00
 Smartphone | iPhone          |  900.00 | 6450.00
 Laptop     | HP Elite        | 1200.00 | 6450.00
 Laptop     | Lenovo Thinkpad |  700.00 | 6450.00
 Laptop     | Sony VAIO       |  700.00 | 6450.00
 Laptop     | Dell            |  800.00 | 6450.00
 Tablet     | iPad            |  700.00 | 6450.00
 Tablet     | Kindle Fire     |  150.00 | 6450.00
 Tablet     | Samsung         |  200.00 | 6450.00
(11 rows)

psql:pg_tests/compatible/window.sql:868: ERROR:  aggregate functions are not allowed in FILTER
LINE 1: SELECT count(*) FILTER (WHERE count(*) > 5) OVER () FROM pro...
                                      ^
psql:pg_tests/compatible/window.sql:874: ERROR:  window functions are not allowed in FILTER
LINE 1: SELECT count(*) FILTER (WHERE count(*) OVER () > 5) OVER () ...
                                      ^
psql:pg_tests/compatible/window.sql:880: ERROR:  argument of FILTER must be type boolean, not type integer
LINE 1: SELECT count(*) FILTER (WHERE 1) OVER () FROM products;
                                      ^
psql:pg_tests/compatible/window.sql:886: ERROR:  syntax error at or near "FILTER"
LINE 1: SELECT price FILTER (WHERE price=1) OVER () FROM products;
                     ^
 count | count 
-------+-------
    11 |     0
    11 |     0
    11 |     0
    11 |     0
    11 |     0
    11 |     0
    11 |     0
    11 |     0
    11 |     0
    11 |     0
    11 |     0
(11 rows)

         avg          |   sum   |         avg          |         avg          
----------------------+---------+----------------------+----------------------
                      |  200.00 | 200.0000000000000000 | 200.0000000000000000
 400.0000000000000000 |  600.00 | 200.0000000000000000 | 300.0000000000000000
 450.0000000000000000 | 1100.00 | 200.0000000000000000 | 366.6666666666666667
 600.0000000000000000 | 2000.00 | 200.0000000000000000 | 366.6666666666666667
 750.0000000000000000 |         | 200.0000000000000000 | 733.3333333333333333
 740.0000000000000000 |         | 450.0000000000000000 | 700.0000000000000000
 733.3333333333333333 |         | 533.3333333333333333 | 700.0000000000000000
 742.8571428571428571 |         | 533.3333333333333333 | 733.3333333333333333
 737.5000000000000000 |         | 575.0000000000000000 | 350.0000000000000000
 737.5000000000000000 |         | 575.0000000000000000 | 150.0000000000000000
 737.5000000000000000 |         | 500.0000000000000000 | 175.0000000000000000
(11 rows)

 count | count 
-------+-------
     3 |    11
     3 |    11
     3 |    11
     3 |    11
     3 |    11
     3 |    11
     3 |    11
     3 |    11
     3 |    11
     3 |    11
     3 |    11
(11 rows)

psql:pg_tests/compatible/window.sql:901: ERROR:  RANGE with offset PRECEDING/FOLLOWING requires exactly one ORDER BY column
LINE 1: SELECT sum(price) OVER (RANGE 100 PRECEDING) FROM products;
                               ^
psql:pg_tests/compatible/window.sql:907: ERROR:  RANGE with offset PRECEDING/FOLLOWING requires exactly one ORDER BY column
LINE 1: SELECT sum(price) OVER (ORDER BY price, priceint RANGE 100 P...
                               ^
psql:pg_tests/compatible/window.sql:913: ERROR:  invalid preceding or following size in window function
psql:pg_tests/compatible/window.sql:919: ERROR:  invalid preceding or following size in window function
psql:pg_tests/compatible/window.sql:925: ERROR:  invalid preceding or following size in window function
psql:pg_tests/compatible/window.sql:931: ERROR:  RANGE with offset PRECEDING/FOLLOWING is not supported for column type timestamp without time zone and offset type numeric
LINE 1: SELECT sum(price) OVER (ORDER BY ptimestamp RANGE 123.4 PREC...
                                                          ^
HINT:  Cast the offset value to an appropriate type.
psql:pg_tests/compatible/window.sql:937: ERROR:  RANGE with offset PRECEDING/FOLLOWING is not supported for column type timestamp with time zone and offset type integer
LINE 1: ...(price) OVER (ORDER BY ptimestamptz RANGE BETWEEN 123 PRECED...
                                                             ^
HINT:  Cast the offset value to an appropriate type.
psql:pg_tests/compatible/window.sql:943: ERROR:  invalid input syntax for type numeric: "1 days"
LINE 1: ...(ORDER BY price RANGE BETWEEN 123.4 PRECEDING AND '1 days' F...
                                                             ^
psql:pg_tests/compatible/window.sql:949: ERROR:  RANGE with offset PRECEDING/FOLLOWING is not supported for column type text
LINE 1: ...LECT sum(price) OVER (ORDER BY product_name RANGE 'foo' PREC...
                                                             ^
 group_name |  product_name   |  price  | sum  
------------+-----------------+---------+------
 Laptop     | Lenovo Thinkpad |  700.00 | 1400
 Laptop     | Sony VAIO       |  700.00 | 1400
 Laptop     | Dell            |  800.00 | 2200
 Laptop     | HP Elite        | 1200.00 | 1200
 Smartphone | Microsoft Lumia |  200.00 |  200
 Smartphone | HTC One         |  400.00 |  600
 Smartphone | Nexus           |  500.00 |  900
 Smartphone | iPhone          |  900.00 |  900
 Tablet     | Kindle Fire     |  150.00 |  150
 Tablet     | Samsung         |  200.00 |  350
 Tablet     | iPad            |  700.00 |  700
(11 rows)

 group_name |  product_name   |  price  |   sum   
------------+-----------------+---------+---------
 Laptop     | Lenovo Thinkpad |  700.00 | 1400.00
 Laptop     | Sony VAIO       |  700.00 | 1400.00
 Laptop     | Dell            |  800.00 | 2200.00
 Laptop     | HP Elite        | 1200.00 | 1200.00
 Smartphone | Microsoft Lumia |  200.00 |  200.00
 Smartphone | HTC One         |  400.00 |  600.00
 Smartphone | Nexus           |  500.00 |  900.00
 Smartphone | iPhone          |  900.00 |  900.00
 Tablet     | Kindle Fire     |  150.00 |  150.00
 Tablet     | Samsung         |  200.00 |  350.00
 Tablet     | iPad            |  700.00 |  700.00
(11 rows)

 group_name |  product_name   |  price  | sum  
------------+-----------------+---------+------
 Laptop     | Lenovo Thinkpad |  700.00 | 1400
 Laptop     | Sony VAIO       |  700.00 | 1400
 Laptop     | Dell            |  800.00 | 2200
 Laptop     | HP Elite        | 1200.00 | 1200
 Smartphone | Microsoft Lumia |  200.00 |  200
 Smartphone | HTC One         |  400.00 |  600
 Smartphone | Nexus           |  500.00 |  900
 Smartphone | iPhone          |  900.00 |  900
 Tablet     | Kindle Fire     |  150.00 |  350
 Tablet     | Samsung         |  200.00 |  350
 Tablet     | iPad            |  700.00 |  700
(11 rows)

 group_name |  product_name   |  price  | sum 
------------+-----------------+---------+-----
 Laptop     | Lenovo Thinkpad |  700.00 |    
 Laptop     | Sony VAIO       |  700.00 |    
 Laptop     | Dell            |  800.00 |    
 Laptop     | HP Elite        | 1200.00 |    
 Smartphone | Microsoft Lumia |  200.00 |    
 Smartphone | HTC One         |  400.00 |    
 Smartphone | Nexus           |  500.00 |    
 Smartphone | iPhone          |  900.00 |    
 Tablet     | Kindle Fire     |  150.00 |    
 Tablet     | Samsung         |  200.00 |    
 Tablet     | iPad            |  700.00 |    
(11 rows)

 group_name |  product_name   |  price  | sum  
------------+-----------------+---------+------
 Laptop     | Lenovo Thinkpad |  700.00 |     
 Laptop     | Sony VAIO       |  700.00 |     
 Laptop     | Dell            |  800.00 | 1400
 Laptop     | HP Elite        | 1200.00 |     
 Smartphone | Microsoft Lumia |  200.00 |     
 Smartphone | HTC One         |  400.00 |  200
 Smartphone | Nexus           |  500.00 |  600
 Smartphone | iPhone          |  900.00 |     
 Tablet     | Kindle Fire     |  150.00 |     
 Tablet     | Samsung         |  200.00 |  150
 Tablet     | iPad            |  700.00 |     
(11 rows)

 group_name |  product_name   |  price  | sum 
------------+-----------------+---------+-----
 Laptop     | Lenovo Thinkpad |  700.00 | 800
 Laptop     | Sony VAIO       |  700.00 | 800
 Laptop     | Dell            |  800.00 |    
 Laptop     | HP Elite        | 1200.00 |    
 Smartphone | Microsoft Lumia |  200.00 | 900
 Smartphone | HTC One         |  400.00 | 500
 Smartphone | Nexus           |  500.00 |    
 Smartphone | iPhone          |  900.00 |    
 Tablet     | Kindle Fire     |  150.00 | 200
 Tablet     | Samsung         |  200.00 |    
 Tablet     | iPad            |  700.00 |    
(11 rows)

 group_name |  price  |  sum   
------------+---------+--------
 Laptop     |  700.00 | 800.00
 Laptop     |  700.00 | 800.00
 Laptop     |  800.00 |       
 Laptop     | 1200.00 |       
 Smartphone |  200.00 | 900.00
 Smartphone |  400.00 | 500.00
 Smartphone |  500.00 |       
 Smartphone |  900.00 |       
 Tablet     |  150.00 | 200.00
 Tablet     |  200.00 |       
 Tablet     |  700.00 |       
(11 rows)

 group_name |  price  | sum 
------------+---------+-----
 Laptop     |  700.00 | 800
 Laptop     |  700.00 | 800
 Laptop     |  800.00 |    
 Laptop     | 1200.00 |    
 Smartphone |  200.00 | 900
 Smartphone |  400.00 | 500
 Smartphone |  500.00 |    
 Smartphone |  900.00 |    
 Tablet     |  150.00 | 200
 Tablet     |  200.00 |    
 Tablet     |  700.00 |    
(11 rows)

 group_name |  product_name   |  price  | nth_value 
------------+-----------------+---------+-----------
 Laptop     | Lenovo Thinkpad |  700.00 |      1200
 Laptop     | Sony VAIO       |  700.00 |      1200
 Laptop     | Dell            |  800.00 |          
 Laptop     | HP Elite        | 1200.00 |          
 Smartphone | Microsoft Lumia |  200.00 |       500
 Smartphone | HTC One         |  400.00 |       900
 Smartphone | Nexus           |  500.00 |          
 Smartphone | iPhone          |  900.00 |          
 Tablet     | Kindle Fire     |  150.00 |          
 Tablet     | Samsung         |  200.00 |          
 Tablet     | iPad            |  700.00 |          
(11 rows)

 group_name |  product_name   |   pdate    |  price  |   sum   
------------+-----------------+------------+---------+---------
 Smartphone | Microsoft Lumia | 2018-07-30 |  200.00 | 3500.00
 Smartphone | Nexus           | 2018-07-30 |  500.00 | 3500.00
 Laptop     | HP Elite        | 2018-07-30 | 1200.00 | 3500.00
 Laptop     | Sony VAIO       | 2018-07-30 |  700.00 | 3500.00
 Tablet     | iPad            | 2018-07-30 |  700.00 | 3500.00
 Tablet     | Samsung         | 2018-07-30 |  200.00 | 3500.00
 Smartphone | HTC One         | 2018-07-31 |  400.00 | 6450.00
 Smartphone | iPhone          | 2018-07-31 |  900.00 | 6450.00
 Laptop     | Lenovo Thinkpad | 2018-07-31 |  700.00 | 6450.00
 Laptop     | Dell            | 2018-07-31 |  800.00 | 6450.00
 Tablet     | Kindle Fire     | 2018-07-31 |  150.00 | 6450.00
(11 rows)

  product_name   |  ptime   |  price  |         avg          
-----------------+----------+---------+----------------------
 Microsoft Lumia | 01:23:45 |  200.00 | 700.0000000000000000
 HP Elite        | 01:23:45 | 1200.00 | 700.0000000000000000
 iPad            | 01:23:45 |  700.00 | 700.0000000000000000
 iPhone          | 07:34:56 |  900.00 | 850.0000000000000000
 Dell            | 07:34:56 |  800.00 | 850.0000000000000000
 Nexus           | 11:23:45 |  500.00 | 441.6666666666666667
 Sony VAIO       | 11:23:45 |  700.00 | 441.6666666666666667
 Samsung         | 11:23:45 |  200.00 | 441.6666666666666667
 HTC One         | 12:34:56 |  400.00 | 441.6666666666666667
 Lenovo Thinkpad | 12:34:56 |  700.00 | 441.6666666666666667
 Kindle Fire     | 12:34:56 |  150.00 | 441.6666666666666667
(11 rows)

 group_name |  product_name   |  ptime   |  price  |  min   
------------+-----------------+----------+---------+--------
 Laptop     | HP Elite        | 01:23:45 | 1200.00 | 700.00
 Laptop     | Dell            | 07:34:56 |  800.00 | 700.00
 Laptop     | Sony VAIO       | 11:23:45 |  700.00 | 700.00
 Laptop     | Lenovo Thinkpad | 12:34:56 |  700.00 |       
 Smartphone | Microsoft Lumia | 01:23:45 |  200.00 | 400.00
 Smartphone | iPhone          | 07:34:56 |  900.00 | 400.00
 Smartphone | Nexus           | 11:23:45 |  500.00 | 400.00
 Smartphone | HTC One         | 12:34:56 |  400.00 |       
 Tablet     | iPad            | 01:23:45 |  700.00 | 150.00
 Tablet     | Samsung         | 11:23:45 |  200.00 | 150.00
 Tablet     | Kindle Fire     | 12:34:56 |  150.00 |       
(11 rows)

 group_name |  product_name   |     ptimestamp      |  price  | first_value 
------------+-----------------+---------------------+---------+-------------
 Laptop     | HP Elite        | 2018-07-30 01:23:45 | 1200.00 |     1200.00
 Laptop     | Sony VAIO       | 2018-07-30 11:23:45 |  700.00 |     1200.00
 Laptop     | Dell            | 2018-07-31 07:34:56 |  800.00 |      800.00
 Laptop     | Lenovo Thinkpad | 2018-07-31 12:34:56 |  700.00 |      800.00
 Smartphone | Microsoft Lumia | 2018-07-30 01:23:45 |  200.00 |      200.00
 Smartphone | Nexus           | 2018-07-30 11:23:45 |  500.00 |      200.00
 Smartphone | iPhone          | 2018-07-31 07:34:56 |  900.00 |      900.00
 Smartphone | HTC One         | 2018-07-31 12:34:56 |  400.00 |      900.00
 Tablet     | iPad            | 2018-07-30 01:23:45 |  700.00 |      700.00
 Tablet     | Samsung         | 2018-07-30 11:23:45 |  200.00 |      700.00
 Tablet     | Kindle Fire     | 2018-07-31 12:34:56 |  150.00 |      150.00
(11 rows)

 group_name |  product_name   |      ptimestamptz      |  price  |          avg          
------------+-----------------+------------------------+---------+-----------------------
 Laptop     | HP Elite        | 2018-07-30 01:23:45+00 | 1200.00 | 1200.0000000000000000
 Laptop     | Sony VAIO       | 2018-07-30 11:23:45+00 |  700.00 |  950.0000000000000000
 Laptop     | Dell            | 2018-07-31 07:34:56+00 |  800.00 |  900.0000000000000000
 Laptop     | Lenovo Thinkpad | 2018-07-31 12:34:56+00 |  700.00 |  850.0000000000000000
 Smartphone | Microsoft Lumia | 2018-07-30 01:23:45+00 |  200.00 |  200.0000000000000000
 Smartphone | Nexus           | 2018-07-30 11:23:45+00 |  500.00 |  350.0000000000000000
 Smartphone | iPhone          | 2018-07-31 07:34:56+00 |  900.00 |  533.3333333333333333
 Smartphone | HTC One         | 2018-07-31 12:34:56+00 |  400.00 |  500.0000000000000000
 Tablet     | iPad            | 2018-07-30 01:23:45+00 |  700.00 |  700.0000000000000000
 Tablet     | Samsung         | 2018-07-30 11:23:45+00 |  200.00 |  450.0000000000000000
 Tablet     | Kindle Fire     | 2018-07-31 12:34:56+00 |  150.00 |  350.0000000000000000
(11 rows)

  product_name   |       pinterval       |  price  |         avg          
-----------------+-----------------------+---------+----------------------
 iPhone          | 00:01:02              |  900.00 | 586.3636363636363636
 Dell            | 00:01:02              |  800.00 | 586.3636363636363636
 Nexus           | 01:02:03              |  500.00 | 586.3636363636363636
 Sony VAIO       | 01:02:03              |  700.00 | 586.3636363636363636
 Samsung         | 01:02:03              |  200.00 | 586.3636363636363636
 HTC One         | 1 day 02:03:04        |  400.00 | 558.3333333333333333
 Lenovo Thinkpad | 1 day 02:03:04        |  700.00 | 558.3333333333333333
 Kindle Fire     | 1 day 02:03:04        |  150.00 | 558.3333333333333333
 Microsoft Lumia | 1 mon 2 days 03:04:05 |  200.00 | 700.0000000000000000
 HP Elite        | 1 mon 2 days 03:04:05 | 1200.00 | 700.0000000000000000
 iPad            | 1 mon 2 days 03:04:05 |  700.00 | 700.0000000000000000
(11 rows)

 group_name |  product_name   |  price  | sum  
------------+-----------------+---------+------
 Laptop     | HP Elite        | 1200.00 | 1200
 Laptop     | Dell            |  800.00 |  800
 Laptop     | Lenovo Thinkpad |  700.00 | 2200
 Laptop     | Sony VAIO       |  700.00 | 2200
 Smartphone | iPhone          |  900.00 |  900
 Smartphone | Nexus           |  500.00 |  500
 Smartphone | HTC One         |  400.00 |  900
 Smartphone | Microsoft Lumia |  200.00 |  600
 Tablet     | iPad            |  700.00 |  700
 Tablet     | Samsung         |  200.00 |  200
 Tablet     | Kindle Fire     |  150.00 |  350
(11 rows)

 group_name |  product_name   |  price  |   sum   
------------+-----------------+---------+---------
 Laptop     | HP Elite        | 1200.00 | 1200.00
 Laptop     | Dell            |  800.00 |  800.00
 Laptop     | Lenovo Thinkpad |  700.00 | 2200.00
 Laptop     | Sony VAIO       |  700.00 | 2200.00
 Smartphone | iPhone          |  900.00 |  900.00
 Smartphone | Nexus           |  500.00 |  500.00
 Smartphone | HTC One         |  400.00 |  900.00
 Smartphone | Microsoft Lumia |  200.00 |  600.00
 Tablet     | iPad            |  700.00 |  700.00
 Tablet     | Samsung         |  200.00 |  200.00
 Tablet     | Kindle Fire     |  150.00 |  350.00
(11 rows)

 group_name |  product_name   |  price  | sum  
------------+-----------------+---------+------
 Laptop     | HP Elite        | 1200.00 | 1200
 Laptop     | Dell            |  800.00 |  800
 Laptop     | Lenovo Thinkpad |  700.00 | 2200
 Laptop     | Sony VAIO       |  700.00 | 2200
 Smartphone | iPhone          |  900.00 |  900
 Smartphone | Nexus           |  500.00 |  500
 Smartphone | HTC One         |  400.00 |  900
 Smartphone | Microsoft Lumia |  200.00 |  600
 Tablet     | iPad            |  700.00 |  700
 Tablet     | Samsung         |  200.00 |  350
 Tablet     | Kindle Fire     |  150.00 |  350
(11 rows)

 group_name |  product_name   |  price  | sum 
------------+-----------------+---------+-----
 Laptop     | HP Elite        | 1200.00 |    
 Laptop     | Dell            |  800.00 |    
 Laptop     | Lenovo Thinkpad |  700.00 |    
 Laptop     | Sony VAIO       |  700.00 |    
 Smartphone | iPhone          |  900.00 |    
 Smartphone | Nexus           |  500.00 |    
 Smartphone | HTC One         |  400.00 |    
 Smartphone | Microsoft Lumia |  200.00 |    
 Tablet     | iPad            |  700.00 |    
 Tablet     | Samsung         |  200.00 |    
 Tablet     | Kindle Fire     |  150.00 |    
(11 rows)

 group_name |  product_name   |  price  | sum 
------------+-----------------+---------+-----
 Laptop     | HP Elite        | 1200.00 |    
 Laptop     | Dell            |  800.00 |    
 Laptop     | Lenovo Thinkpad |  700.00 | 800
 Laptop     | Sony VAIO       |  700.00 | 800
 Smartphone | iPhone          |  900.00 |    
 Smartphone | Nexus           |  500.00 |    
 Smartphone | HTC One         |  400.00 | 500
 Smartphone | Microsoft Lumia |  200.00 | 900
 Tablet     | iPad            |  700.00 |    
 Tablet     | Samsung         |  200.00 |    
 Tablet     | Kindle Fire     |  150.00 | 200
(11 rows)

 group_name |  product_name   |  price  | sum  
------------+-----------------+---------+------
 Laptop     | HP Elite        | 1200.00 |     
 Laptop     | Dell            |  800.00 | 1400
 Laptop     | Lenovo Thinkpad |  700.00 |     
 Laptop     | Sony VAIO       |  700.00 |     
 Smartphone | iPhone          |  900.00 |     
 Smartphone | Nexus           |  500.00 |  600
 Smartphone | HTC One         |  400.00 |  200
 Smartphone | Microsoft Lumia |  200.00 |     
 Tablet     | iPad            |  700.00 |     
 Tablet     | Samsung         |  200.00 |  150
 Tablet     | Kindle Fire     |  150.00 |     
(11 rows)

 group_name |  price  |   sum   
------------+---------+---------
 Laptop     | 1200.00 |        
 Laptop     |  800.00 | 1400.00
 Laptop     |  700.00 |        
 Laptop     |  700.00 |        
 Smartphone |  900.00 |        
 Smartphone |  500.00 |  600.00
 Smartphone |  400.00 |  200.00
 Smartphone |  200.00 |        
 Tablet     |  700.00 |        
 Tablet     |  200.00 |  150.00
 Tablet     |  150.00 |        
(11 rows)

 group_name |  price  | sum  
------------+---------+------
 Laptop     | 1200.00 |     
 Laptop     |  800.00 | 1400
 Laptop     |  700.00 |     
 Laptop     |  700.00 |     
 Smartphone |  900.00 |     
 Smartphone |  500.00 |  600
 Smartphone |  400.00 |  200
 Smartphone |  200.00 |     
 Tablet     |  700.00 |     
 Tablet     |  200.00 |  150
 Tablet     |  150.00 |     
(11 rows)

 group_name |  product_name   |  price  | nth_value 
------------+-----------------+---------+-----------
 Laptop     | HP Elite        | 1200.00 |       700
 Laptop     | Dell            |  800.00 |       700
 Laptop     | Lenovo Thinkpad |  700.00 |          
 Laptop     | Sony VAIO       |  700.00 |          
 Smartphone | iPhone          |  900.00 |       400
 Smartphone | Nexus           |  500.00 |       200
 Smartphone | HTC One         |  400.00 |          
 Smartphone | Microsoft Lumia |  200.00 |          
 Tablet     | iPad            |  700.00 |          
 Tablet     | Samsung         |  200.00 |          
 Tablet     | Kindle Fire     |  150.00 |          
(11 rows)

 group_name |  product_name   |   pdate    |  price  |   sum   
------------+-----------------+------------+---------+---------
 Smartphone | HTC One         | 2018-07-31 |  400.00 | 2950.00
 Smartphone | iPhone          | 2018-07-31 |  900.00 | 2950.00
 Laptop     | Lenovo Thinkpad | 2018-07-31 |  700.00 | 2950.00
 Laptop     | Dell            | 2018-07-31 |  800.00 | 2950.00
 Tablet     | Kindle Fire     | 2018-07-31 |  150.00 | 2950.00
 Smartphone | Microsoft Lumia | 2018-07-30 |  200.00 | 6450.00
 Smartphone | Nexus           | 2018-07-30 |  500.00 | 6450.00
 Laptop     | HP Elite        | 2018-07-30 | 1200.00 | 6450.00
 Laptop     | Sony VAIO       | 2018-07-30 |  700.00 | 6450.00
 Tablet     | iPad            | 2018-07-30 |  700.00 | 6450.00
 Tablet     | Samsung         | 2018-07-30 |  200.00 | 6450.00
(11 rows)

  product_name   |  ptime   |  price  |         avg          
-----------------+----------+---------+----------------------
 HTC One         | 12:34:56 |  400.00 | 441.6666666666666667
 Lenovo Thinkpad | 12:34:56 |  700.00 | 441.6666666666666667
 Kindle Fire     | 12:34:56 |  150.00 | 441.6666666666666667
 Nexus           | 11:23:45 |  500.00 | 441.6666666666666667
 Sony VAIO       | 11:23:45 |  700.00 | 441.6666666666666667
 Samsung         | 11:23:45 |  200.00 | 441.6666666666666667
 iPhone          | 07:34:56 |  900.00 | 850.0000000000000000
 Dell            | 07:34:56 |  800.00 | 850.0000000000000000
 Microsoft Lumia | 01:23:45 |  200.00 | 700.0000000000000000
 HP Elite        | 01:23:45 | 1200.00 | 700.0000000000000000
 iPad            | 01:23:45 |  700.00 | 700.0000000000000000
(11 rows)

 group_name |  product_name   |  ptime   |  price  |   min   
------------+-----------------+----------+---------+---------
 Laptop     | Lenovo Thinkpad | 12:34:56 |  700.00 |  700.00
 Laptop     | Sony VAIO       | 11:23:45 |  700.00 |  800.00
 Laptop     | Dell            | 07:34:56 |  800.00 | 1200.00
 Laptop     | HP Elite        | 01:23:45 | 1200.00 |        
 Smartphone | HTC One         | 12:34:56 |  400.00 |  200.00
 Smartphone | Nexus           | 11:23:45 |  500.00 |  200.00
 Smartphone | iPhone          | 07:34:56 |  900.00 |  200.00
 Smartphone | Microsoft Lumia | 01:23:45 |  200.00 |        
 Tablet     | Kindle Fire     | 12:34:56 |  150.00 |  200.00
 Tablet     | Samsung         | 11:23:45 |  200.00 |  700.00
 Tablet     | iPad            | 01:23:45 |  700.00 |        
(11 rows)

 group_name |  product_name   |     ptimestamp      |  price  | first_value 
------------+-----------------+---------------------+---------+-------------
 Laptop     | Lenovo Thinkpad | 2018-07-31 12:34:56 |  700.00 |      700.00
 Laptop     | Dell            | 2018-07-31 07:34:56 |  800.00 |      700.00
 Laptop     | Sony VAIO       | 2018-07-30 11:23:45 |  700.00 |      700.00
 Laptop     | HP Elite        | 2018-07-30 01:23:45 | 1200.00 |      700.00
 Smartphone | HTC One         | 2018-07-31 12:34:56 |  400.00 |      400.00
 Smartphone | iPhone          | 2018-07-31 07:34:56 |  900.00 |      400.00
 Smartphone | Nexus           | 2018-07-30 11:23:45 |  500.00 |      500.00
 Smartphone | Microsoft Lumia | 2018-07-30 01:23:45 |  200.00 |      500.00
 Tablet     | Kindle Fire     | 2018-07-31 12:34:56 |  150.00 |      150.00
 Tablet     | Samsung         | 2018-07-30 11:23:45 |  200.00 |      200.00
 Tablet     | iPad            | 2018-07-30 01:23:45 |  700.00 |      200.00
(11 rows)

 group_name |  product_name   |      ptimestamptz      |  price  |         avg          
------------+-----------------+------------------------+---------+----------------------
 Laptop     | Lenovo Thinkpad | 2018-07-31 12:34:56+00 |  700.00 | 700.0000000000000000
 Laptop     | Dell            | 2018-07-31 07:34:56+00 |  800.00 | 750.0000000000000000
 Laptop     | Sony VAIO       | 2018-07-30 11:23:45+00 |  700.00 | 733.3333333333333333
 Laptop     | HP Elite        | 2018-07-30 01:23:45+00 | 1200.00 | 850.0000000000000000
 Smartphone | HTC One         | 2018-07-31 12:34:56+00 |  400.00 | 400.0000000000000000
 Smartphone | iPhone          | 2018-07-31 07:34:56+00 |  900.00 | 650.0000000000000000
 Smartphone | Nexus           | 2018-07-30 11:23:45+00 |  500.00 | 600.0000000000000000
 Smartphone | Microsoft Lumia | 2018-07-30 01:23:45+00 |  200.00 | 500.0000000000000000
 Tablet     | Kindle Fire     | 2018-07-31 12:34:56+00 |  150.00 | 150.0000000000000000
 Tablet     | Samsung         | 2018-07-30 11:23:45+00 |  200.00 | 175.0000000000000000
 Tablet     | iPad            | 2018-07-30 01:23:45+00 |  700.00 | 350.0000000000000000
(11 rows)

  product_name   |       pinterval       |  price  |         avg          
-----------------+-----------------------+---------+----------------------
 Microsoft Lumia | 1 mon 2 days 03:04:05 |  200.00 | 586.3636363636363636
 HP Elite        | 1 mon 2 days 03:04:05 | 1200.00 | 586.3636363636363636
 iPad            | 1 mon 2 days 03:04:05 |  700.00 | 586.3636363636363636
 HTC One         | 1 day 02:03:04        |  400.00 | 543.7500000000000000
 Lenovo Thinkpad | 1 day 02:03:04        |  700.00 | 543.7500000000000000
 Kindle Fire     | 1 day 02:03:04        |  150.00 | 543.7500000000000000
 Nexus           | 01:02:03              |  500.00 | 620.0000000000000000
 Sony VAIO       | 01:02:03              |  700.00 | 620.0000000000000000
 Samsung         | 01:02:03              |  200.00 | 620.0000000000000000
 iPhone          | 00:01:02              |  900.00 | 620.0000000000000000
 Dell            | 00:01:02              |  800.00 | 620.0000000000000000
(11 rows)

 group_name |  price  |  product_name   |                    array_agg                    
------------+---------+-----------------+-------------------------------------------------
 Smartphone |  200.00 | Microsoft Lumia | {"Microsoft Lumia"}
 Smartphone |  400.00 | HTC One         | {"Microsoft Lumia","HTC One"}
 Smartphone |  500.00 | Nexus           | {"Microsoft Lumia","HTC One",Nexus}
 Smartphone |  900.00 | iPhone          | {"Microsoft Lumia","HTC One",Nexus,iPhone}
 Laptop     | 1200.00 | HP Elite        | {"Lenovo Thinkpad","Sony VAIO",Dell,"HP Elite"}
 Laptop     |  700.00 | Lenovo Thinkpad | {"Lenovo Thinkpad"}
 Laptop     |  700.00 | Sony VAIO       | {"Lenovo Thinkpad","Sony VAIO"}
 Laptop     |  800.00 | Dell            | {"Lenovo Thinkpad","Sony VAIO",Dell}
 Tablet     |  700.00 | iPad            | {"Kindle Fire",Samsung,iPad}
 Tablet     |  150.00 | Kindle Fire     | {"Kindle Fire"}
 Tablet     |  200.00 | Samsung         | {"Kindle Fire",Samsung}
(11 rows)

  product_name   |                                                      array_agg                                                      
-----------------+---------------------------------------------------------------------------------------------------------------------
 Microsoft Lumia | {"Microsoft Lumia"}
 HTC One         | {"Microsoft Lumia","HTC One"}
 Nexus           | {"Microsoft Lumia","HTC One",Nexus}
 iPhone          | {"Microsoft Lumia","HTC One",Nexus,iPhone}
 HP Elite        | {"Microsoft Lumia","HTC One",Nexus,iPhone,"HP Elite"}
 Lenovo Thinkpad | {"Microsoft Lumia","HTC One",Nexus,iPhone,"HP Elite","Lenovo Thinkpad"}
 Sony VAIO       | {"Microsoft Lumia","HTC One",Nexus,iPhone,"HP Elite","Lenovo Thinkpad","Sony VAIO"}
 Dell            | {"Microsoft Lumia","HTC One",Nexus,iPhone,"HP Elite","Lenovo Thinkpad","Sony VAIO",Dell}
 iPad            | {"Microsoft Lumia","HTC One",Nexus,iPhone,"HP Elite","Lenovo Thinkpad","Sony VAIO",Dell,iPad}
 Kindle Fire     | {"Microsoft Lumia","HTC One",Nexus,iPhone,"HP Elite","Lenovo Thinkpad","Sony VAIO",Dell,iPad,"Kindle Fire"}
 Samsung         | {"Microsoft Lumia","HTC One",Nexus,iPhone,"HP Elite","Lenovo Thinkpad","Sony VAIO",Dell,iPad,"Kindle Fire",Samsung}
(11 rows)

psql:pg_tests/compatible/window.sql:1051: ERROR:  GROUPS mode requires an ORDER BY clause
LINE 1: SELECT avg(price) OVER (GROUPS group_id PRECEDING) FROM prod...
                               ^
psql:pg_tests/compatible/window.sql:1057: ERROR:  GROUPS mode requires an ORDER BY clause
LINE 1: SELECT avg(price) OVER (GROUPS 1 PRECEDING) FROM products;
                               ^
psql:pg_tests/compatible/window.sql:1063: ERROR:  frame starting offset must not be null
psql:pg_tests/compatible/window.sql:1069: ERROR:  frame starting offset must not be null
psql:pg_tests/compatible/window.sql:1075: ERROR:  frame starting offset must not be negative
psql:pg_tests/compatible/window.sql:1081: ERROR:  frame starting offset must not be negative
psql:pg_tests/compatible/window.sql:1087: ERROR:  frame ending offset must not be null
psql:pg_tests/compatible/window.sql:1093: ERROR:  frame ending offset must not be negative
psql:pg_tests/compatible/window.sql:1099: ERROR:  frame ending offset must not be negative
psql:pg_tests/compatible/window.sql:1105: ERROR:  frame ending offset must not be negative
       avg_price       
-----------------------
 1200.0000000000000000
  950.0000000000000000
  866.6666666666666667
  733.3333333333333333
  200.0000000000000000
  300.0000000000000000
  366.6666666666666667
  600.0000000000000000
  700.0000000000000000
  425.0000000000000000
  350.0000000000000000
(11 rows)

       avg_price       
-----------------------
 1200.0000000000000000
  950.0000000000000000
  866.6666666666666667
  733.3333333333333333
  200.0000000000000000
  300.0000000000000000
  366.6666666666666667
  600.0000000000000000
  700.0000000000000000
  425.0000000000000000
  350.0000000000000000
(11 rows)

      avg_price       
----------------------
 850.0000000000000000
 850.0000000000000000
 850.0000000000000000
 733.3333333333333333
 500.0000000000000000
 500.0000000000000000
 500.0000000000000000
 600.0000000000000000
 350.0000000000000000
 350.0000000000000000
 350.0000000000000000
(11 rows)

      avg_price       
----------------------
 850.0000000000000000
 850.0000000000000000
 850.0000000000000000
 733.3333333333333333
 500.0000000000000000
 500.0000000000000000
 500.0000000000000000
 600.0000000000000000
 350.0000000000000000
 350.0000000000000000
 350.0000000000000000
(11 rows)

      avg_price       
----------------------
 866.6666666666666667
 850.0000000000000000
 850.0000000000000000
 850.0000000000000000
 366.6666666666666667
 500.0000000000000000
 500.0000000000000000
 500.0000000000000000
 350.0000000000000000
 350.0000000000000000
 350.0000000000000000
(11 rows)

      avg_price       
----------------------
 866.6666666666666667
 850.0000000000000000
 850.0000000000000000
 850.0000000000000000
 366.6666666666666667
 500.0000000000000000
 500.0000000000000000
 500.0000000000000000
 350.0000000000000000
 350.0000000000000000
 350.0000000000000000
(11 rows)

  price  |   sum   |   sum   |   sum   |   sum   
---------+---------+---------+---------+---------
  150.00 |  150.00 |  150.00 |  150.00 | 1050.00
  200.00 |  550.00 |  550.00 |  550.00 | 2000.00
  200.00 |  550.00 |  550.00 |  550.00 | 1050.00
  400.00 |  950.00 |  950.00 |  800.00 | 2000.00
  500.00 | 1450.00 | 1450.00 |  900.00 | 2000.00
  700.00 | 3550.00 | 3550.00 | 2600.00 | 3400.00
  700.00 | 3550.00 | 3550.00 | 2600.00 | 3400.00
  700.00 | 3550.00 | 3550.00 | 2600.00 | 1050.00
  800.00 | 4350.00 | 4350.00 | 2900.00 | 3400.00
  900.00 | 5250.00 | 5250.00 | 1700.00 | 2000.00
 1200.00 | 6450.00 | 6450.00 | 2100.00 | 3400.00
(11 rows)

  price  | dense_rank | avg |         avg          |         avg          |         avg          |         avg          |         avg          
---------+------------+-----+----------------------+----------------------+----------------------+----------------------+----------------------
  150.00 |          1 |     |                      | 150.0000000000000000 | 237.5000000000000000 | 586.3636363636363636 | 586.3636363636363636
  200.00 |          2 |     |                      | 183.3333333333333333 | 290.0000000000000000 | 586.3636363636363636 | 586.3636363636363636
  200.00 |          2 |     |                      | 183.3333333333333333 | 290.0000000000000000 | 586.3636363636363636 | 586.3636363636363636
  400.00 |          3 |     | 150.0000000000000000 | 237.5000000000000000 | 443.7500000000000000 | 586.3636363636363636 | 586.3636363636363636
  500.00 |          4 |     | 183.3333333333333333 | 290.0000000000000000 | 483.3333333333333333 | 586.3636363636363636 | 586.3636363636363636
  700.00 |          5 |     | 237.5000000000000000 | 443.7500000000000000 | 525.0000000000000000 | 586.3636363636363636 | 586.3636363636363636
  700.00 |          5 |     | 237.5000000000000000 | 443.7500000000000000 | 525.0000000000000000 | 586.3636363636363636 | 586.3636363636363636
  700.00 |          5 |     | 237.5000000000000000 | 443.7500000000000000 | 525.0000000000000000 | 586.3636363636363636 | 586.3636363636363636
  800.00 |          6 |     | 290.0000000000000000 | 483.3333333333333333 | 586.3636363636363636 | 586.3636363636363636 | 586.3636363636363636
  900.00 |          7 |     | 443.7500000000000000 | 525.0000000000000000 | 586.3636363636363636 | 586.3636363636363636 | 586.3636363636363636
 1200.00 |          8 |     | 483.3333333333333333 | 586.3636363636363636 | 586.3636363636363636 | 586.3636363636363636 | 586.3636363636363636
(11 rows)

  price  | dense_rank | avg |         avg          |         avg          |          avg          |          avg          |          avg          
---------+------------+-----+----------------------+----------------------+-----------------------+-----------------------+-----------------------
  150.00 |          1 |     |                      | 150.0000000000000000 |  237.5000000000000000 |  586.3636363636363636 |  586.3636363636363636
  200.00 |          2 |     |                      | 183.3333333333333333 |  290.0000000000000000 |  586.3636363636363636 |  586.3636363636363636
  200.00 |          2 |     |                      | 183.3333333333333333 |  290.0000000000000000 |  586.3636363636363636 |  586.3636363636363636
  400.00 |          3 |     | 150.0000000000000000 | 237.5000000000000000 |  485.7142857142857143 |  630.0000000000000000 |  630.0000000000000000
  500.00 |          4 |     | 183.3333333333333333 | 325.0000000000000000 |  633.3333333333333333 |  737.5000000000000000 |  737.5000000000000000
  700.00 |          5 |     | 266.6666666666666667 | 600.0000000000000000 |  716.6666666666666667 |  785.7142857142857143 |  785.7142857142857143
  700.00 |          5 |     | 266.6666666666666667 | 600.0000000000000000 |  716.6666666666666667 |  785.7142857142857143 |  785.7142857142857143
  700.00 |          5 |     | 266.6666666666666667 | 600.0000000000000000 |  716.6666666666666667 |  785.7142857142857143 |  785.7142857142857143
  800.00 |          6 |     | 450.0000000000000000 | 680.0000000000000000 |  833.3333333333333333 |  833.3333333333333333 |  833.3333333333333333
  900.00 |          7 |     | 650.0000000000000000 | 760.0000000000000000 |  966.6666666666666667 |  966.6666666666666667 |  966.6666666666666667
 1200.00 |          8 |     | 725.0000000000000000 | 966.6666666666666667 | 1050.0000000000000000 | 1050.0000000000000000 | 1050.0000000000000000
(11 rows)

  price  | dense_rank |          avg          |          avg          |          avg          |          avg          |          avg          |          avg          |          avg          
---------+------------+-----------------------+-----------------------+-----------------------+-----------------------+-----------------------+-----------------------+-----------------------
  150.00 |          1 |  150.0000000000000000 |  150.0000000000000000 |  150.0000000000000000 |  150.0000000000000000 |  237.5000000000000000 |  586.3636363636363636 |  586.3636363636363636
  200.00 |          2 |  200.0000000000000000 |  200.0000000000000000 |  200.0000000000000000 |  200.0000000000000000 |  325.0000000000000000 |  630.0000000000000000 |  630.0000000000000000
  200.00 |          2 |  200.0000000000000000 |  200.0000000000000000 |  200.0000000000000000 |  200.0000000000000000 |  325.0000000000000000 |  630.0000000000000000 |  630.0000000000000000
  400.00 |          3 |  400.0000000000000000 |  400.0000000000000000 |  400.0000000000000000 |  400.0000000000000000 |  600.0000000000000000 |  737.5000000000000000 |  737.5000000000000000
  500.00 |          4 |  500.0000000000000000 |  500.0000000000000000 |  500.0000000000000000 |  500.0000000000000000 |  680.0000000000000000 |  785.7142857142857143 |  785.7142857142857143
  700.00 |          5 |  700.0000000000000000 |  700.0000000000000000 |  700.0000000000000000 |  700.0000000000000000 |  760.0000000000000000 |  833.3333333333333333 |  833.3333333333333333
  700.00 |          5 |  700.0000000000000000 |  700.0000000000000000 |  700.0000000000000000 |  700.0000000000000000 |  760.0000000000000000 |  833.3333333333333333 |  833.3333333333333333
  700.00 |          5 |  700.0000000000000000 |  700.0000000000000000 |  700.0000000000000000 |  700.0000000000000000 |  760.0000000000000000 |  833.3333333333333333 |  833.3333333333333333
  800.00 |          6 |  800.0000000000000000 |  800.0000000000000000 |  800.0000000000000000 |  800.0000000000000000 |  966.6666666666666667 |  966.6666666666666667 |  966.6666666666666667
  900.00 |          7 |  900.0000000000000000 |  900.0000000000000000 |  900.0000000000000000 |  900.0000000000000000 | 1050.0000000000000000 | 1050.0000000000000000 | 1050.0000000000000000
 1200.00 |          8 | 1200.0000000000000000 | 1200.0000000000000000 | 1200.0000000000000000 | 1200.0000000000000000 | 1200.0000000000000000 | 1200.0000000000000000 | 1200.0000000000000000
(11 rows)

  price  | dense_rank |          avg          | avg |          avg          |          avg          |          avg          |          avg          
---------+------------+-----------------------+-----+-----------------------+-----------------------+-----------------------+-----------------------
  150.00 |          1 |  785.7142857142857143 |     |  671.4285714285714286 |  500.0000000000000000 |  443.7500000000000000 |  966.6666666666666667
  200.00 |          2 |  833.3333333333333333 |     |  785.7142857142857143 |  700.0000000000000000 |  525.0000000000000000 | 1050.0000000000000000
  200.00 |          2 |  833.3333333333333333 |     |  785.7142857142857143 |  700.0000000000000000 |  525.0000000000000000 | 1050.0000000000000000
  400.00 |          3 |  966.6666666666666667 |     |  833.3333333333333333 |  800.0000000000000000 |  671.4285714285714286 | 1200.0000000000000000
  500.00 |          4 | 1050.0000000000000000 |     |  966.6666666666666667 |  900.0000000000000000 |  785.7142857142857143 |                      
  700.00 |          5 | 1200.0000000000000000 |     | 1050.0000000000000000 | 1200.0000000000000000 |  833.3333333333333333 |                      
  700.00 |          5 | 1200.0000000000000000 |     | 1050.0000000000000000 | 1200.0000000000000000 |  833.3333333333333333 |                      
  700.00 |          5 | 1200.0000000000000000 |     | 1050.0000000000000000 | 1200.0000000000000000 |  833.3333333333333333 |                      
  800.00 |          6 |                       |     | 1200.0000000000000000 |                       |  966.6666666666666667 |                      
  900.00 |          7 |                       |     |                       |                       | 1050.0000000000000000 |                      
 1200.00 |          8 |                       |     |                       |                       | 1200.0000000000000000 |                      
(11 rows)

 group_name |  product_name   |  price  |          avg          |         avg          
------------+-----------------+---------+-----------------------+----------------------
 Smartphone | Microsoft Lumia |  200.00 |  500.0000000000000000 | 586.3636363636363636
 Smartphone | HTC One         |  400.00 |  600.0000000000000000 | 586.3636363636363636
 Smartphone | Nexus           |  500.00 |  700.0000000000000000 | 586.3636363636363636
 Smartphone | iPhone          |  900.00 |  900.0000000000000000 | 586.3636363636363636
 Laptop     | HP Elite        | 1200.00 | 1200.0000000000000000 | 586.3636363636363636
 Laptop     | Lenovo Thinkpad |  700.00 |  850.0000000000000000 | 586.3636363636363636
 Laptop     | Sony VAIO       |  700.00 |  850.0000000000000000 | 586.3636363636363636
 Laptop     | Dell            |  800.00 | 1000.0000000000000000 | 586.3636363636363636
 Tablet     | iPad            |  700.00 |  700.0000000000000000 | 586.3636363636363636
 Tablet     | Kindle Fire     |  150.00 |  350.0000000000000000 | 586.3636363636363636
 Tablet     | Samsung         |  200.00 |  450.0000000000000000 | 586.3636363636363636
(11 rows)

 group_name |  product_name   |  price  | avg |          avg          
------------+-----------------+---------+-----+-----------------------
 Smartphone | Microsoft Lumia |  200.00 |     |  200.0000000000000000
 Smartphone | HTC One         |  400.00 |     |  400.0000000000000000
 Smartphone | Nexus           |  500.00 |     |  500.0000000000000000
 Smartphone | iPhone          |  900.00 |     |  900.0000000000000000
 Laptop     | HP Elite        | 1200.00 |     | 1200.0000000000000000
 Laptop     | Lenovo Thinkpad |  700.00 |     |  700.0000000000000000
 Laptop     | Sony VAIO       |  700.00 |     |  700.0000000000000000
 Laptop     | Dell            |  800.00 |     |  800.0000000000000000
 Tablet     | iPad            |  700.00 |     |  700.0000000000000000
 Tablet     | Kindle Fire     |  150.00 |     |  150.0000000000000000
 Tablet     | Samsung         |  200.00 |     |  200.0000000000000000
(11 rows)

  price  |                                array_agg                                |   sum   
---------+-------------------------------------------------------------------------+---------
  150.00 |                                                                         |        
  200.00 | {150.00,200.00}                                                         |  350.00
  200.00 | {150.00,200.00}                                                         |  350.00
  400.00 | {150.00,200.00,200.00}                                                  |  550.00
  500.00 | {150.00,200.00,200.00,400.00}                                           |  950.00
  700.00 | {150.00,200.00,200.00,400.00,500.00,700.00,700.00}                      | 2850.00
  700.00 | {150.00,200.00,200.00,400.00,500.00,700.00,700.00}                      | 2850.00
  700.00 | {150.00,200.00,200.00,400.00,500.00,700.00,700.00}                      | 2850.00
  800.00 | {150.00,200.00,200.00,400.00,500.00,700.00,700.00,700.00}               | 3550.00
  900.00 | {150.00,200.00,200.00,400.00,500.00,700.00,700.00,700.00,800.00}        | 4350.00
 1200.00 | {150.00,200.00,200.00,400.00,500.00,700.00,700.00,700.00,800.00,900.00} | 5250.00
(11 rows)

  price  |                                array_agg                                |  max   
---------+-------------------------------------------------------------------------+--------
  150.00 |                                                                         |       
  200.00 | {150.00}                                                                | 150.00
  200.00 | {150.00}                                                                | 150.00
  400.00 | {150.00,200.00,200.00}                                                  | 200.00
  500.00 | {150.00,200.00,200.00,400.00}                                           | 400.00
  700.00 | {150.00,200.00,200.00,400.00,500.00}                                    | 500.00
  700.00 | {150.00,200.00,200.00,400.00,500.00}                                    | 500.00
  700.00 | {150.00,200.00,200.00,400.00,500.00}                                    | 500.00
  800.00 | {150.00,200.00,200.00,400.00,500.00,700.00,700.00,700.00}               | 700.00
  900.00 | {150.00,200.00,200.00,400.00,500.00,700.00,700.00,700.00,800.00}        | 800.00
 1200.00 | {150.00,200.00,200.00,400.00,500.00,700.00,700.00,700.00,800.00,900.00} | 900.00
(11 rows)

  price  |                                    array_agg                                    |         avg          
---------+---------------------------------------------------------------------------------+----------------------
  150.00 | {150.00}                                                                        | 150.0000000000000000
  200.00 | {150.00,200.00}                                                                 | 175.0000000000000000
  200.00 | {150.00,200.00}                                                                 | 175.0000000000000000
  400.00 | {150.00,200.00,200.00,400.00}                                                   | 237.5000000000000000
  500.00 | {150.00,200.00,200.00,400.00,500.00}                                            | 290.0000000000000000
  700.00 | {150.00,200.00,200.00,400.00,500.00,700.00}                                     | 358.3333333333333333
  700.00 | {150.00,200.00,200.00,400.00,500.00,700.00}                                     | 358.3333333333333333
  700.00 | {150.00,200.00,200.00,400.00,500.00,700.00}                                     | 358.3333333333333333
  800.00 | {150.00,200.00,200.00,400.00,500.00,700.00,700.00,700.00,800.00}                | 483.3333333333333333
  900.00 | {150.00,200.00,200.00,400.00,500.00,700.00,700.00,700.00,800.00,900.00}         | 525.0000000000000000
 1200.00 | {150.00,200.00,200.00,400.00,500.00,700.00,700.00,700.00,800.00,900.00,1200.00} | 586.3636363636363636
(11 rows)

  price  |                                    array_agg                                    |         avg          
---------+---------------------------------------------------------------------------------+----------------------
  150.00 | {150.00}                                                                        | 150.0000000000000000
  200.00 | {150.00,200.00,200.00}                                                          | 183.3333333333333333
  200.00 | {150.00,200.00,200.00}                                                          | 183.3333333333333333
  400.00 | {150.00,200.00,200.00,400.00}                                                   | 237.5000000000000000
  500.00 | {150.00,200.00,200.00,400.00,500.00}                                            | 290.0000000000000000
  700.00 | {150.00,200.00,200.00,400.00,500.00,700.00,700.00,700.00}                       | 443.7500000000000000
  700.00 | {150.00,200.00,200.00,400.00,500.00,700.00,700.00,700.00}                       | 443.7500000000000000
  700.00 | {150.00,200.00,200.00,400.00,500.00,700.00,700.00,700.00}                       | 443.7500000000000000
  800.00 | {150.00,200.00,200.00,400.00,500.00,700.00,700.00,700.00,800.00}                | 483.3333333333333333
  900.00 | {150.00,200.00,200.00,400.00,500.00,700.00,700.00,700.00,800.00,900.00}         | 525.0000000000000000
 1200.00 | {150.00,200.00,200.00,400.00,500.00,700.00,700.00,700.00,800.00,900.00,1200.00} | 586.3636363636363636
(11 rows)

   first_value   |   first_value   |   first_value   |   first_value   
-----------------+-----------------+-----------------+-----------------
                 |                 | Microsoft Lumia | Microsoft Lumia
 Microsoft Lumia | Microsoft Lumia | Microsoft Lumia | Microsoft Lumia
 Microsoft Lumia | Microsoft Lumia | Microsoft Lumia | Microsoft Lumia
 Microsoft Lumia | Microsoft Lumia | Microsoft Lumia | Microsoft Lumia
 Microsoft Lumia | Microsoft Lumia | Microsoft Lumia | Microsoft Lumia
 Microsoft Lumia | Microsoft Lumia | Microsoft Lumia | Microsoft Lumia
 Microsoft Lumia | Microsoft Lumia | Microsoft Lumia | Microsoft Lumia
 Microsoft Lumia | Microsoft Lumia | Microsoft Lumia | Microsoft Lumia
 Microsoft Lumia | Microsoft Lumia | Microsoft Lumia | Microsoft Lumia
 Microsoft Lumia | Microsoft Lumia | Microsoft Lumia | Microsoft Lumia
 Microsoft Lumia | Microsoft Lumia | Microsoft Lumia | Microsoft Lumia
(11 rows)

   last_value    |   last_value    |   last_value    |   last_value    
-----------------+-----------------+-----------------+-----------------
                 |                 | Microsoft Lumia | Microsoft Lumia
 Microsoft Lumia | Microsoft Lumia | HTC One         | HTC One
 HTC One         | HTC One         | Nexus           | Nexus
 Nexus           | Nexus           | iPhone          | iPhone
 iPhone          | iPhone          | HP Elite        | HP Elite
 HP Elite        | HP Elite        | Lenovo Thinkpad | Lenovo Thinkpad
 Lenovo Thinkpad | Lenovo Thinkpad | Sony VAIO       | Sony VAIO
 Sony VAIO       | Sony VAIO       | Dell            | Dell
 Dell            | Dell            | iPad            | iPad
 iPad            | iPad            | Kindle Fire     | Kindle Fire
 Kindle Fire     | Kindle Fire     | Samsung         | Samsung
(11 rows)

 nth_value | nth_value | nth_value | nth_value 
-----------+-----------+-----------+-----------
           |           |           | 
           |           |           | 
 HTC One   |           |           | 
 HTC One   | Nexus     | iPhone    | 
 HTC One   | Nexus     | iPhone    | HP Elite
 HTC One   | Nexus     | iPhone    | HP Elite
 HTC One   | Nexus     | iPhone    | HP Elite
 HTC One   | Nexus     | iPhone    | HP Elite
 HTC One   | Nexus     | iPhone    | HP Elite
 HTC One   | Nexus     | iPhone    | HP Elite
 HTC One   | Nexus     | iPhone    | HP Elite
(11 rows)

CREATE TABLE
INSERT 0 3
 a | json_agg  
---+-----------
 1 | [1]
 2 | [1, 2]
 3 | [1, 2, 3]
(3 rows)

 row_number 
------------
          1
          1
          1
(3 rows)

psql:pg_tests/compatible/window.sql:1306: ERROR:  window functions are not allowed in window definitions
LINE 1: SELECT sum(a) OVER (PARTITION BY count(a) OVER ()) FROM x;
                                         ^
psql:pg_tests/compatible/window.sql:1312: ERROR:  window functions are not allowed in window definitions
LINE 1: SELECT sum(a) OVER (ORDER BY count(a) OVER ()) FROM x;
                                     ^
psql:pg_tests/compatible/window.sql:1318: ERROR:  window functions are not allowed in window definitions
LINE 1: SELECT sum(a) OVER (PARTITION BY count(a) OVER () + 1) FROM ...
                                         ^
psql:pg_tests/compatible/window.sql:1324: ERROR:  window functions are not allowed in window definitions
LINE 1: SELECT sum(a) OVER (ORDER BY count(a) OVER () + 1) FROM x;
                                     ^
 sum 
-----
   6
   6
   6
(3 rows)

 min | max 
-----+-----
   1 |   1
(1 row)

 min | max 
-----+-----
   1 |   1
(1 row)

 string_agg 
------------
 foo
(1 row)

 jsonb_agg 
-----------
 
 
 
(3 rows)

CREATE TABLE
INSERT 0 6
        avg         |          avg           |        avg         |        avg         |         avg         |         avg         |         avg         |         avg         |         avg         |         avg         |         avg         |         avg         
--------------------+------------------------+--------------------+--------------------+---------------------+---------------------+---------------------+---------------------+---------------------+---------------------+---------------------+---------------------
 3.5000000000000000 | 1.00000000000000000000 | 3.5000000000000000 | 2.0000000000000000 | 10.0000000000000000 | 10.0000000000000000 | 10.0000000000000000 | 10.0000000000000000 | 25.0000000000000000 | 20.0000000000000000 | 25.0000000000000000 | 20.0000000000000000
 3.5000000000000000 |     1.5000000000000000 | 3.5000000000000000 | 2.0000000000000000 | 10.0000000000000000 | 10.0000000000000000 | 10.0000000000000000 | 10.0000000000000000 | 25.0000000000000000 | 20.0000000000000000 | 25.0000000000000000 | 20.0000000000000000
 3.5000000000000000 |     2.0000000000000000 | 3.5000000000000000 | 2.0000000000000000 | 10.0000000000000000 | 10.0000000000000000 | 10.0000000000000000 | 10.0000000000000000 | 25.0000000000000000 | 20.0000000000000000 | 25.0000000000000000 | 20.0000000000000000
 3.5000000000000000 |     2.5000000000000000 | 3.5000000000000000 | 3.5000000000000000 | 10.0000000000000000 | 10.0000000000000000 | 10.0000000000000000 | 10.0000000000000000 | 25.0000000000000000 | 22.5000000000000000 | 25.0000000000000000 | 25.0000000000000000
 3.5000000000000000 |     3.0000000000000000 | 3.5000000000000000 | 3.5000000000000000 | 10.0000000000000000 | 10.0000000000000000 | 10.0000000000000000 | 10.0000000000000000 | 25.0000000000000000 | 24.0000000000000000 | 25.0000000000000000 | 25.0000000000000000
 3.5000000000000000 |     3.5000000000000000 | 3.5000000000000000 | 3.5000000000000000 | 10.0000000000000000 | 10.0000000000000000 | 10.0000000000000000 | 10.0000000000000000 | 25.0000000000000000 | 25.0000000000000000 | 25.0000000000000000 | 25.0000000000000000
(6 rows)

        avg         |        avg         |        avg         |        avg         |         avg         |         avg         |         avg         |         avg         |         avg         |         avg         |         avg         |         avg         
--------------------+--------------------+--------------------+--------------------+---------------------+---------------------+---------------------+---------------------+---------------------+---------------------+---------------------+---------------------
 3.5000000000000000 | 3.5000000000000000 | 3.5000000000000000 | 3.5000000000000000 | 10.0000000000000000 | 10.0000000000000000 | 10.0000000000000000 | 10.0000000000000000 | 25.0000000000000000 | 25.0000000000000000 | 25.0000000000000000 | 25.0000000000000000
 3.5000000000000000 | 3.5000000000000000 | 3.5000000000000000 | 3.5000000000000000 | 10.0000000000000000 | 10.0000000000000000 | 10.0000000000000000 | 10.0000000000000000 | 25.0000000000000000 | 25.0000000000000000 | 25.0000000000000000 | 25.0000000000000000
 3.5000000000000000 | 3.5000000000000000 | 3.5000000000000000 | 3.5000000000000000 | 10.0000000000000000 | 10.0000000000000000 | 10.0000000000000000 | 10.0000000000000000 | 25.0000000000000000 | 25.0000000000000000 | 25.0000000000000000 | 25.0000000000000000
 3.5000000000000000 | 3.5000000000000000 | 3.5000000000000000 | 3.5000000000000000 | 10.0000000000000000 | 10.0000000000000000 | 10.0000000000000000 | 10.0000000000000000 | 25.0000000000000000 | 25.0000000000000000 | 25.0000000000000000 | 25.0000000000000000
 3.5000000000000000 | 3.5000000000000000 | 3.5000000000000000 | 3.5000000000000000 | 10.0000000000000000 | 10.0000000000000000 | 10.0000000000000000 | 10.0000000000000000 | 25.0000000000000000 | 25.0000000000000000 | 25.0000000000000000 | 25.0000000000000000
 3.5000000000000000 | 3.5000000000000000 | 3.5000000000000000 | 3.5000000000000000 | 10.0000000000000000 | 10.0000000000000000 | 10.0000000000000000 | 10.0000000000000000 | 25.0000000000000000 | 25.0000000000000000 | 25.0000000000000000 | 25.0000000000000000
(6 rows)

 array_agg 
-----------
 {2,1}
 {3,2}
 {3}
(3 rows)

psql:pg_tests/compatible/window.sql:1400: ERROR:  GROUPS mode requires an ORDER BY clause
LINE 1: SELECT array_agg(a) OVER (w GROUPS 1 PRECEDING) FROM x WINDO...
                                 ^
 array_agg 
-----------
 {1}
 {2}
 {3}
(3 rows)

DROP TABLE
CREATE TABLE
INSERT 0 3
 min 
-----
   1
   1
   1
(3 rows)

 a | b | sum 
---+---+-----
 1 | 1 |   1
 2 |   |    
 3 | 3 |   3
(3 rows)

 a | b |        avg         
---+---+--------------------
 1 | 1 | 2.0000000000000000
 2 |   | 2.0000000000000000
 3 | 3 | 2.0000000000000000
(3 rows)

 a | b |          avg           
---+---+------------------------
 1 | 1 | 1.00000000000000000000
 2 |   |                       
 3 | 3 |     3.0000000000000000
(3 rows)

CREATE TABLE
INSERT 0 6
 w | x  | y | z | rank 
---+----+---+---+------
 1 | 10 | 1 | 1 |    1
 3 | 10 | 1 | 1 |    1
(2 rows)

 w | x  | y | z | dense_rank 
---+----+---+---+------------
 1 | 10 | 1 | 1 |          1
 3 | 10 | 1 | 1 |          1
(2 rows)

 w | x  | y | z |        avg         
---+----+---+---+--------------------
 1 | 10 | 1 | 1 | 2.0000000000000000
 3 | 10 | 1 | 1 | 2.0000000000000000
(2 rows)

 w | x  | y | z | rank 
---+----+---+---+------
 1 | 10 | 1 | 1 |    1
 3 | 10 | 1 | 1 |    1
(2 rows)

 w | x  | y | z | dense_rank 
---+----+---+---+------------
 1 | 10 | 1 | 1 |          1
 3 | 10 | 1 | 1 |          1
(2 rows)

 w | x  | y | z |          avg           
---+----+---+---+------------------------
 1 | 10 | 1 | 1 | 1.00000000000000000000
 3 | 10 | 1 | 1 |     3.0000000000000000
(2 rows)

 w | x  | y | z | rank 
---+----+---+---+------
 1 | 10 | 1 | 1 |    1
 2 | 10 | 2 | 0 |    1
(2 rows)

 w | x  | y | z | dense_rank 
---+----+---+---+------------
 1 | 10 | 1 | 1 |          1
 2 | 10 | 2 | 0 |          1
(2 rows)

 w | x  | y | z |          avg           
---+----+---+---+------------------------
 1 | 10 | 1 | 1 | 1.00000000000000000000
 2 | 10 | 2 | 0 |     2.0000000000000000
(2 rows)

 w | x  | y | z | rank 
---+----+---+---+------
 1 | 10 | 1 | 1 |    1
 2 | 10 | 2 | 0 |    1
(2 rows)

 w | x  | y | z | dense_rank 
---+----+---+---+------------
 1 | 10 | 1 | 1 |          1
 2 | 10 | 2 | 0 |          1
(2 rows)

 w | x  | y | z |          avg           
---+----+---+---+------------------------
 1 | 10 | 1 | 1 | 1.00000000000000000000
 2 | 10 | 2 | 0 |     2.0000000000000000
(2 rows)

 w | x  | y | z | rank 
---+----+---+---+------
 1 | 10 | 1 | 1 |    1
 3 | 10 | 1 | 1 |    1
(2 rows)

 w | x  | y | z | dense_rank 
---+----+---+---+------------
 1 | 10 | 1 | 1 |          1
 3 | 10 | 1 | 1 |          1
(2 rows)

 w | x  | y | z |          avg           
---+----+---+---+------------------------
 1 | 10 | 1 | 1 | 1.00000000000000000000
 3 | 10 | 1 | 1 |     3.0000000000000000
(2 rows)

 w | x  | y | z | rank 
---+----+---+---+------
 1 | 10 | 1 | 1 |    1
 2 | 10 | 2 | 0 |    1
(2 rows)

 w | x  | y | z | dense_rank 
---+----+---+---+------------
 1 | 10 | 1 | 1 |          1
 2 | 10 | 2 | 0 |          1
(2 rows)

 w | x  | y | z |          avg           
---+----+---+---+------------------------
 1 | 10 | 1 | 1 | 1.00000000000000000000
 2 | 10 | 2 | 0 |     2.0000000000000000
(2 rows)

 w | x  | y | z | rank 
---+----+---+---+------
 2 | 10 | 2 | 0 |    1
 4 | 10 | 2 | 0 |    1
(2 rows)

 w | x  | y | z | dense_rank 
---+----+---+---+------------
 2 | 10 | 2 | 0 |          1
 4 | 10 | 2 | 0 |          1
(2 rows)

 w | x  | y | z |        avg         
---+----+---+---+--------------------
 2 | 10 | 2 | 0 | 2.0000000000000000
 4 | 10 | 2 | 0 | 4.0000000000000000
(2 rows)

DROP TABLE
CREATE TABLE
INSERT 0 10
 company_id | string_agg 
------------+------------
          1 | A
          2 | B
          2 | B,B
          3 | C
          3 | C,C
          3 | C,C,C
          4 | D
          4 | D,D
          4 | D,D,D
          4 | D,D,D,D
(10 rows)

 company_id |    string_agg    
------------+------------------
          1 | \x41
          2 | \x42
          2 | \x422c42
          3 | \x43
          3 | \x432c43
          3 | \x432c432c43
          4 | \x44
          4 | \x442c44
          4 | \x442c442c44
          4 | \x442c442c442c44
(10 rows)

 company_id | string_agg 
------------+------------
          1 | A
          2 | B
          2 | BB
          3 | C
          3 | CC
          3 | CCC
          4 | D
          4 | DD
          4 | DDD
          4 | DDDD
(10 rows)

 company_id | string_agg 
------------+------------
          1 | \x41
          2 | \x42
          2 | \x4242
          3 | \x43
          3 | \x4343
          3 | \x434343
          4 | \x44
          4 | \x4444
          4 | \x444444
          4 | \x44444444
(10 rows)

 company_id | string_agg 
------------+------------
          1 | A
          2 | B
          2 | BB
          3 | C
          3 | CC
          3 | CCC
          4 | D
          4 | DD
          4 | DDD
          4 | DDDD
(10 rows)

 company_id | string_agg 
------------+------------
          1 | \x41
          2 | \x42
          2 | \x4242
          3 | \x43
          3 | \x4343
          3 | \x434343
          4 | \x44
          4 | \x4444
          4 | \x444444
          4 | \x44444444
(10 rows)

 company_id | string_agg 
------------+------------
          1 | 
          2 | 
          2 | 
          3 | 
          3 | 
          3 | 
          4 | 
          4 | 
          4 | 
          4 | 
(10 rows)

 company_id | string_agg 
------------+------------
          1 | 
          2 | 
          2 | 
          3 | 
          3 | 
          3 | 
          4 | 
          4 | 
          4 | 
          4 | 
(10 rows)

 company_id | string_agg 
------------+------------
          1 | 
          2 | 
          2 | 
          3 | 
          3 | 
          3 | 
          4 | 
          4 | 
          4 | 
          4 | 
(10 rows)

 company_id | string_agg 
------------+------------
          1 | 
          2 | 
          2 | 
          3 | 
          3 | 
          3 | 
          4 | 
          4 | 
          4 | 
          4 | 
(10 rows)

 company_id | string_agg 
------------+------------
          1 | A
          2 | BbB
          2 | BbB
          3 | CcCcC
          3 | CcCcC
          3 | CcCcC
          4 | DdDdDdD
          4 | DdDdDdD
          4 | DdDdDdD
          4 | DdDdDdD
(10 rows)

 company_id | string_agg 
------------+------------
          1 | a
          2 | bBb
          2 | bBb
          3 | cCcCc
          3 | cCcCc
          3 | cCcCc
          4 | dDdDdDd
          4 | dDdDdDd
          4 | dDdDdDd
          4 | dDdDdDd
(10 rows)

psql:pg_tests/compatible/window.sql:1600: ERROR:  function string_agg(text, text, text) does not exist
LINE 1: SELECT company_id, string_agg(employee, employee, employee)
                           ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
CREATE TABLE
INSERT 0 3
 array_agg 
-----------
 
 {1}
 {1,2}
(3 rows)

 a | b | count | count | count 
---+---+-------+-------+-------
 1 | 1 |     2 |     2 |     1
 2 | 1 |     2 |     2 |     2
 3 | 2 |     4 |     4 |     3
 4 | 2 |     4 |     4 |     4
(4 rows)

 k  | v | w |  d  |  f   | s | b |      i       |         array_agg         |  array_agg  |              array_agg              |    array_agg     | array_agg |          array_agg          |       array_agg       |       array_agg       
----+---+---+-----+------+---+---+--------------+---------------------------+-------------+-------------------------------------+------------------+-----------+-----------------------------+-----------------------+-----------------------
  1 | 2 | 3 | 1.0 |    1 | a | t | 00:01:00     | {NULL,NULL,4,4,4,2,2,2,2} |             | {-321,1}                            |                  | {1.0}     |                             | {00:01:00}            | 
  3 | 4 | 5 |   2 |    8 | a | t | 00:00:02     | {NULL,NULL,4,4,4}         |             | {-321,1,3,4.4,7.9,8}                |                  | {2}       | {1.0,0.3,0.2,0.1}           | {00:00:02}            | 
  5 |   | 5 | 9.9 | -321 |   | f |              | {NULL,NULL}               | {NULL,NULL} | {-321}                              |                  | {9.9}     | {6,4.4,3,2,1.0,0.3,0.2,0.1} | {NULL,NULL,NULL,NULL} | {NULL,NULL,NULL,NULL}
  6 | 2 | 3 | 4.4 |  4.4 | b | t | 00:00:00.001 | {NULL,NULL,4,4,4,2,2,2,2} |             | {-321,1,3,4.4}                      |                  | {4.4}     | {3,2,1.0,0.3,0.2,0.1}       | {00:00:00.001}        | 
  7 | 2 | 2 |   6 |  7.9 | b | t | 4 days       | {NULL,NULL,4,4,4,2,2,2,2} |             | {-321,1,3,4.4,7.9}                  |                  | {6}       | {4.4,3,2,1.0,0.3,0.2,0.1}   | {"4 days"}            | 
  8 | 4 | 2 |   3 |    3 | A | f | 3 years      | {NULL,NULL,4,4,4}         |             | {-321,1,3}                          |                  | {3}       | {2,1.0,0.3,0.2,0.1}         | {"3 years"}           | 
  9 | 2 | 9 | 0.1 |      |   |   |              | {NULL,NULL,4,4,4,2,2,2,2} |             | {-321,1,3,4.4,7.9,8,NULL,NULL,NULL} | {NULL,NULL,NULL} | {0.1}     |                             | {NULL,NULL,NULL,NULL} | {NULL,NULL,NULL,NULL}
 10 | 4 | 9 | 0.2 |      |   |   |              | {NULL,NULL,4,4,4}         |             | {-321,1,3,4.4,7.9,8,NULL,NULL,NULL} | {NULL,NULL,NULL} | {0.2}     |                             | {NULL,NULL,NULL,NULL} | {NULL,NULL,NULL,NULL}
 11 |   | 9 | 0.3 |      |   |   |              | {NULL,NULL}               | {NULL,NULL} | {-321,1,3,4.4,7.9,8,NULL,NULL,NULL} | {NULL,NULL,NULL} | {0.3}     |                             | {NULL,NULL,NULL,NULL} | {NULL,NULL,NULL,NULL}
(9 rows)

 k  | v | w |  d  |  f   | s | b |      i       |  array_agg  |  array_agg  |    array_agg     |    array_agg     | array_agg | array_agg |       array_agg       |       array_agg       
----+---+---+-----+------+---+---+--------------+-------------+-------------+------------------+------------------+-----------+-----------+-----------------------+-----------------------
  1 | 2 | 3 | 1.0 |    1 | a | t | 00:01:00     | {2,2,2,2}   |             | {1}              |                  | {1.0}     |           | {00:01:00}            | 
  3 | 4 | 5 |   2 |    8 | a | t | 00:00:02     | {4,4,4}     |             | {8}              |                  | {2}       |           | {00:00:02}            | 
  5 |   | 5 | 9.9 | -321 |   | f |              | {NULL,NULL} | {NULL,NULL} | {-321}           |                  | {9.9}     |           | {NULL,NULL,NULL,NULL} | {NULL,NULL,NULL,NULL}
  6 | 2 | 3 | 4.4 |  4.4 | b | t | 00:00:00.001 | {2,2,2,2}   |             | {4.4}            |                  | {4.4}     |           | {00:00:00.001}        | 
  7 | 2 | 2 |   6 |  7.9 | b | t | 4 days       | {2,2,2,2}   |             | {7.9}            |                  | {6}       |           | {"4 days"}            | 
  8 | 4 | 2 |   3 |    3 | A | f | 3 years      | {4,4,4}     |             | {3}              |                  | {3}       |           | {"3 years"}           | 
  9 | 2 | 9 | 0.1 |      |   |   |              | {2,2,2,2}   |             | {NULL,NULL,NULL} | {NULL,NULL,NULL} | {0.1}     |           | {NULL,NULL,NULL,NULL} | {NULL,NULL,NULL,NULL}
 10 | 4 | 9 | 0.2 |      |   |   |              | {4,4,4}     |             | {NULL,NULL,NULL} | {NULL,NULL,NULL} | {0.2}     |           | {NULL,NULL,NULL,NULL} | {NULL,NULL,NULL,NULL}
 11 |   | 9 | 0.3 |      |   |   |              | {NULL,NULL} | {NULL,NULL} | {NULL,NULL,NULL} | {NULL,NULL,NULL} | {0.3}     |           | {NULL,NULL,NULL,NULL} | {NULL,NULL,NULL,NULL}
(9 rows)

 max | max 
-----+-----
     |   8
     |   8
     |   7
     |   7
     |   7
     |   7
     |  11
     |  11
     |  11
(9 rows)

CREATE TABLE
CREATE TABLE
 max 
-----
(0 rows)

 max 
-----
(0 rows)

CREATE TABLE
INSERT 0 3
           json_object_agg           
-------------------------------------
 { "c" : "c" }
 { "c" : "c", "b" : "b" }
 { "c" : "c", "b" : "b", "a" : "a" }
(3 rows)

        jsonb_object_agg        
--------------------------------
 {"a": "a"}
 {"a": "a", "b": "b"}
 {"a": "a", "b": "b", "c": "c"}
(3 rows)

CREATE TABLE
INSERT 0 10
  x   |        sqrdiff        |       var_pop        |       var_samp       |     stddev_pop      |     stddev_samp     
------+-----------------------+----------------------+----------------------+---------------------+---------------------
  1.0 |                     0 |                    0 |                      |                   0 |                    
 20.0 |  180.5000000000000000 |  90.2500000000000000 | 180.5000000000000000 |  9.5000000000000000 | 13.4350288425444030
 25.0 |  320.6666666666666667 | 106.8888888888888889 | 160.3333333333333333 | 10.3387082795138818 | 12.6622799421483860
 41.0 |  814.7500000000000000 | 203.6875000000000000 | 271.5833333333333333 | 14.2719129761920844 | 16.4797855973108259
 55.5 | 1726.0000000000000000 | 345.2000000000000000 | 431.5000000000000000 | 18.5795586599897469 | 20.7725780778409881
 60.9 | 2600.8000000000000002 | 433.4666666666666667 | 520.1600000000000000 | 20.8198623114243161 | 22.8070164642374913
 72.0 | 3845.0371428571428571 | 549.2910204081632653 | 640.8395238095238095 | 23.4369584291171039 | 25.3148083897453944
 88.0 | 7527.8422222222222224 | 836.4269135802469136 | 940.9802777777777778 | 28.9210462048012176 | 30.6754018356366080
 88.0 | 7527.8422222222222224 | 836.4269135802469136 | 940.9802777777777778 | 28.9210462048012176 | 30.6754018356366080
 89.0 | 8885.8440000000000000 | 888.5844000000000000 | 987.3160000000000000 | 29.8091328287154304 | 31.4215849377462180
(10 rows)

CREATE TABLE
INSERT 0 2
  lag  
-------
 alpha
 
(2 rows)

CREATE TABLE
INSERT 0 2
psql:pg_tests/compatible/window.sql:1747: ERROR:  window frame head moved backward
 max 
-----
   2
   2
(2 rows)

 max 
-----
   2
   2
(2 rows)

 max 
-----
    
    
(2 rows)

 k  | first_value 
----+-------------
  1 |            
  3 |            
  5 |            
  6 |            
  7 |            
  8 |            
  9 |            
 10 |            
 11 |            
(9 rows)

 min 
-----
   1
   1
    
(3 rows)

DROP TABLE
CREATE TABLE
INSERT 0 2
 first_value  
--------------
 1999-01-08
 294276-01-01
(2 rows)

DROP TABLE
CREATE TABLE
INSERT 0 3
 a  | max | min 
----+-----+-----
    |   1 |  -1
  1 |   1 |  -1
 -1 |   1 |  -1
(3 rows)

DROP TABLE
CREATE TABLE
INSERT 0 3
 x | y  | first_value 
---+----+-------------
 1 | 10 |          10
 1 | 20 |          20
 2 | 30 |          30
(3 rows)

SELECT 5
 lag | lead | first_value | last_value | nth_value | min | row_number | rank | dense_rank | percent_rank | cume_dist | ntile 
-----+------+-------------+------------+-----------+-----+------------+------+------------+--------------+-----------+-------
   1 |    2 |           1 |          1 |         1 |   1 |          1 |    1 |          1 |            0 |       0.2 |     1
   2 |    4 |           1 |          2 |         2 |   1 |          2 |    2 |          2 |         0.25 |       0.4 |     1
   3 |    3 |           1 |          3 |         3 |   1 |          3 |    3 |          3 |          0.5 |       0.6 |     1
   4 |    4 |           1 |          4 |         4 |   1 |          4 |    4 |          4 |         0.75 |       0.8 |     1
   5 |    5 |           1 |          5 |         5 |   1 |          5 |    5 |          5 |            1 |         1 |     1
(5 rows)

 lead 
------
    2
(1 row)

CREATE TABLE
INSERT 0 4
 id | row_num_using_nulls_last | row_num_using_coalesce 
----+--------------------------+------------------------
  1 |                        1 |                      1
  2 |                        2 |                      2
  3 |                        3 |                      3
    |                        4 |                      4
(4 rows)

 id | row_num_using_nulls_last | row_num_using_coalesce 
----+--------------------------+------------------------
  1 |                        1 |                      1
  2 |                        2 |                      2
  3 |                        3 |                      3
    |                        4 |                      4
(4 rows)

